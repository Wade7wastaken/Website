var EJS=function(r){window.EJS_MODULES=r;var n={},o=[];function i(e){if(n[e])return n[e].exports;o.push(e);var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}return window.getUsedModules=function(){return o.sort(function(e,t){return t<e?1:-1})},window.getUnusedModules=function(){for(var e=[],t=getUsedModules(),n=0;n<r.length;n++)null===r[n]||t.includes(n)||e.push(n);return e},Array.isArray,i.m=r,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=162)}([function(e){e.exports=function(e,t,n){console.warn(e),e&&e.response&&0===e.response.status?t.innerHTML='<strong style="color:#f00;text-shadow: 0px 0px 3px;"><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors">'+n.localization("CORS Error")+"</a></strong>":t.innerHTML='<strong style="color:#f00;text-shadow: 0px 0px 3px;">'+n.localization("Network Error")+"</strong>"}},null,null,null,null,null,function(e){e.exports=class{gamepads;timeout;listeners;constructor(){this.gamepads=[],this.listeners={},this.timeout=null,this.loop()}terminate(){window.clearTimeout(this.timeout)}getGamepads(){return navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[]}loop(){this.updateGamepadState(),this.timeout=setTimeout(this.loop.bind(this),10)}updateGamepadState(){const r=this.getGamepads();r.forEach((i,n)=>{if(i){let t=!1;this.gamepads.forEach((o,e)=>{o.index===i.index&&(t=!0,o.axes.forEach((e,t)=>{if(i.axes[t]!==e){const e=["LEFT_STICK_X","LEFT_STICK_Y","RIGHT_STICK_X","RIGHT_STICK_Y"][t];e&&this.dispatchEvent("axischanged",{axis:e,value:i.axes[t],index:i.index,gamepadIndex:i.index})}}),i.buttons.forEach((e,t)=>{let n=1===o.buttons[t],r=("object"==typeof o.buttons[t]&&(n=o.buttons[t].pressed),1===e);"object"==typeof e&&(r=e.pressed),n!==r&&(r?this.dispatchEvent("buttondown",{index:t,gamepadIndex:i.index}):this.dispatchEvent("buttonup",{index:t,gamepadIndex:i.index}))}),this.gamepads[e]=r[n])}),t||(this.gamepads.push(r[n]),this.dispatchEvent("connected",{gamepadIndex:i.index}))}});for(let n=0;n<this.gamepads.length;n++)if(this.gamepads[n]){let t=!1;for(let e=0;e<r.length;e++)if(r[e]&&this.gamepads[n].index===r[e].index){t=!0;break}t||(this.dispatchEvent("disconnected",{gamepadIndex:this.gamepads[n].index}),this.gamepads.splice(n,1),n--)}}dispatchEvent(e,t){"function"==typeof this.listeners[e]&&((t=t||{}).type=e,this.listeners[e](t))}on(e,t){this.listeners[e.toLowerCase()]=t}}},null,null,null,null,function(e,t,n){function r(r,o){let e;try{e=new URL(r)}catch(e){}return e&&["http:","https:"].includes(e.protocol)||!e?new Promise(function(t,e){let n=new XMLHttpRequest;o.onProgress&&n.addEventListener("progress",o.onProgress),n.onload=function(){if(n.readyState===n.DONE){let e=n.response;try{e=JSON.parse(e)}catch(e){}t({data:e,headers:{"content-length":n.getResponseHeader("content-length"),"content-type":n.getResponseHeader("content-type"),"last-modified":n.getResponseHeader("last-modified")}})}},n.responseType=o.type,n.onerror=e,n.open(o.method,r,!0),n.send()}):new Promise(async function(t,n){if("HEAD"===o.method)t({headers:{}});else{let e;try{if(e=await fetch(r),o.type&&"arraybuffer"===o.type.toLowerCase())e=await e.arrayBuffer();else{e=await e.text();try{e=JSON.parse(e)}catch(e){}}}catch(e){n(e)}r.startsWith("blob:")&&URL.revokeObjectURL(r),t({data:e,headers:{}})}})}e.exports={a:{get:async function(e,t){var n=t&&t.responseType?t&&t.responseType:"text",t=t&&t.onDownloadProgress;return r(e,{method:"GET",type:n,onProgress:t})},head:async function(e,t){var n=t&&t.responseType?t&&t.responseType:"text",t=t&&t.onDownloadProgress;return r(e,{method:"HEAD",type:n,onProgress:t})}}}},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,function(e,t){var n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,function(e,t){var n,r,e=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return(n=setTimeout)(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}var a,c=[],u=!1,d=-1;function l(){u&&a&&(u=!1,a.length?c=a.concat(c):d=-1,c.length)&&f()}function f(){if(!u){var e=s(l);u=!0;for(var t=c.length;t;){for(a=c,c=[];++d<t;)a&&a[d].run();d=-1,t=c.length}a=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===i||!r)&&clearTimeout)return(r=clearTimeout)(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}e.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||u||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=h,e.addListener=h,e.once=h,e.off=h,e.removeListener=h,e.removeAllListeners=h,e.emit=h,e.prependListener=h,e.prependOnceListener=h,e.listeners=function(e){return[]},e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},null,null,null,null,null,null,null,function(e,t,n){var r;!function(){"use strict";void 0!==(r="function"==typeof(r=function(){function l(e){throw e}function f(){}function e(e,t){for(var n in void 0===t&&"function"==typeof e&&(t=e),"[object Object]"!=Object.prototype.toString.call(e)&&(e={}),o)this[n]=(void 0!==e[n]?e:o)[n];this.dbName=this.storePrefix+this.storeName,this.dbVersion=parseInt(this.dbVersion,10)||1,t&&(this.onStoreReady=t);var r="object"==typeof window?window:self,t=this.implementationPreference.filter(function(e){return e in r});this.implementation=t[0],this.idb=r[this.implementation],this.keyRange=r.IDBKeyRange||r.webkitIDBKeyRange||r.mozIDBKeyRange,this.consts={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange",NEXT:"next",NEXT_NO_DUPLICATE:"nextunique",PREV:"prev",PREV_NO_DUPLICATE:"prevunique"},this.openDB()}var o={storeName:"Store",storePrefix:"IDBWrapper-",dbVersion:1,keyPath:"id",autoIncrement:!0,onStoreReady:function(){},onError:l,indexes:[],implementationPreference:["indexedDB","webkitIndexedDB","mozIndexedDB","shimIndexedDB"]},t={constructor:e,version:"1.7.2",db:null,dbName:null,dbVersion:null,store:null,storeName:null,storePrefix:null,keyPath:null,autoIncrement:null,indexes:null,implementationPreference:null,implementation:"",onStoreReady:null,onError:null,_insertIdCount:0,openDB:function(){var e=this.idb.open(this.dbName,this.dbVersion),o=!1;e.onerror=function(e){var t;("error"in(t=e).target?"VersionError"==t.target.error.name:"errorCode"in t.target&&12==t.target.errorCode)?this.onError(new Error("The version number provided is lower than the existing one.")):(e=e.target.error||(t="IndexedDB unknown error occurred when opening DB "+this.dbName+" version "+this.dbVersion,"errorCode"in e.target&&(t+=" with error code "+e.target.errorCode),new Error(t)),this.onError(e))}.bind(this),e.onsuccess=function(e){var r;o||(this.db?this.onStoreReady():(this.db=e.target.result,"string"!=typeof this.db.version?this.db.objectStoreNames.contains(this.storeName)?(e=this.db.transaction([this.storeName],this.consts.READ_ONLY),this.store=e.objectStore(this.storeName),r=Array.prototype.slice.call(this.getIndexList()),this.indexes.forEach(function(e){var t,n=e.name;n?(this.normalizeIndexData(e),this.hasIndex(n)?(t=this.store.index(n),this.indexComplies(t,e)||(o=!0,this.onError(new Error('Cannot modify index "'+n+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),r.splice(r.indexOf(n),1)):(o=!0,this.onError(new Error('Cannot create new index "'+n+'" for current version. Please bump version number to '+(this.dbVersion+1)+".")))):(o=!0,this.onError(new Error("Cannot create index: No index name given.")))},this),r.length&&(o=!0,this.onError(new Error('Cannot delete index(es) "'+r.toString()+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),o||this.onStoreReady()):this.onError(new Error("Object store couldn't be created.")):this.onError(new Error("The IndexedDB implementation in this browser is outdated. Please upgrade your browser."))))}.bind(this),e.onupgradeneeded=function(e){this.db=e.target.result,this.db.objectStoreNames.contains(this.storeName)?this.store=e.target.transaction.objectStore(this.storeName):(e={autoIncrement:this.autoIncrement},null!==this.keyPath&&(e.keyPath=this.keyPath),this.store=this.db.createObjectStore(this.storeName,e));var r=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(e){var t,n=e.name;n||(o=!0,this.onError(new Error("Cannot create index: No index name given."))),this.normalizeIndexData(e),this.hasIndex(n)?(t=this.store.index(n),this.indexComplies(t,e)||(this.store.deleteIndex(n),this.store.createIndex(n,e.keyPath,{unique:e.unique,multiEntry:e.multiEntry})),r.splice(r.indexOf(n),1)):this.store.createIndex(n,e.keyPath,{unique:e.unique,multiEntry:e.multiEntry})},this),r.length&&r.forEach(function(e){this.store.deleteIndex(e)},this)}.bind(this)},deleteDatabase:function(e,t){var n;this.idb.deleteDatabase?(this.db.close(),(n=this.idb.deleteDatabase(this.dbName)).onsuccess=e,n.onerror=t):t(new Error("Browser does not support IndexedDB deleteDatabase!"))},put:function(e,t,n,r){null!==this.keyPath&&(r=n,n=t,t=e),r=r||l,n=n||f;var o=!1,i=null,s=this.db.transaction([this.storeName],this.consts.READ_WRITE);return s.oncomplete=function(){(o?n:r)(i)},s.onabort=r,s.onerror=r,(t=null!==this.keyPath?(this._addIdPropertyIfNeeded(t),s.objectStore(this.storeName).put(t)):s.objectStore(this.storeName).put(t,e)).onsuccess=function(e){o=!0,i=e.target.result},t.onerror=r,s},get:function(e,t,n){n=n||l,t=t||f;var r=!1,o=null,i=this.db.transaction([this.storeName],this.consts.READ_ONLY),e=(i.oncomplete=function(){(r?t:n)(o)},i.onabort=n,i.onerror=n,i.objectStore(this.storeName).get(e));return e.onsuccess=function(e){r=!0,o=e.target.result},e.onerror=n,i},remove:function(e,t,n){n=n||l,t=t||f;var r=!1,o=null,i=this.db.transaction([this.storeName],this.consts.READ_WRITE),e=(i.oncomplete=function(){(r?t:n)(o)},i.onabort=n,i.onerror=n,i.objectStore(this.storeName).delete(e));return e.onsuccess=function(e){r=!0,o=e.target.result},e.onerror=n,i},batch:function(e,t,i){if(i=i||l,t=t||f,"[object Array]"!=Object.prototype.toString.call(e))i(new Error("dataArray argument must be of type Array."));else if(0===e.length)return t(!0);function s(){0!=--n||a||(r=a=!0)}var n=e.length,a=!1,r=!1,c=this.db.transaction([this.storeName],this.consts.READ_WRITE);c.oncomplete=function(){(r?t:i)(r)},c.onabort=i,c.onerror=i;return e.forEach(function(e){function t(e){c.abort(),a||(a=!0,i(e,r,o))}var n,r=e.type,o=e.key,e=e.value;"remove"==r?((n=c.objectStore(this.storeName).delete(o)).onsuccess=s,n.onerror=t):"put"==r&&((n=null!==this.keyPath?(this._addIdPropertyIfNeeded(e),c.objectStore(this.storeName).put(e)):c.objectStore(this.storeName).put(e,o)).onsuccess=s,n.onerror=t)},this),c},putBatch:function(e,t,n){e=e.map(function(e){return{type:"put",value:e}});return this.batch(e,t,n)},upsertBatch:function(t,e,n,r){"function"==typeof e&&(r=n=e,e={}),r=r||l,n=n||f,e=e||{},"[object Array]"!=Object.prototype.toString.call(t)&&r(new Error("dataArray argument must be of type Array."));function o(e){t[u++][i]=e.target.result,0!=--s||a||(c=a=!0)}var i=e.keyField||this.keyPath,s=t.length,a=!1,c=!1,u=0,d=this.db.transaction([this.storeName],this.consts.READ_WRITE);d.oncomplete=function(){c?n(t):r(!1)},d.onabort=r,d.onerror=r;return t.forEach(function(e){var t=e.key,e=null!==this.keyPath?(this._addIdPropertyIfNeeded(e),d.objectStore(this.storeName).put(e)):d.objectStore(this.storeName).put(e,t);e.onsuccess=o,e.onerror=function(e){d.abort(),a||(a=!0,r(e))}},this),d},removeBatch:function(e,t,n){e=e.map(function(e){return{type:"remove",key:e}});return this.batch(e,t,n)},getBatch:function(e,t,n,r){if(n=n||l,t=t||f,r=r||"sparse","[object Array]"!=Object.prototype.toString.call(e))n(new Error("keyArray argument must be of type Array."));else if(0===e.length)return t([]);function o(e){e.target.result||"dense"==r?i.push(e.target.result):"sparse"==r&&i.length++,0==--s&&(a=!0,c=i)}var i=[],s=e.length,a=!1,c=null,u=this.db.transaction([this.storeName],this.consts.READ_ONLY);u.oncomplete=function(){(a?t:n)(c)},u.onabort=n,u.onerror=n;return e.forEach(function(e){e=u.objectStore(this.storeName).get(e);e.onsuccess=o,e.onerror=function(e){n(c=e),u.abort()}},this),u},getAll:function(e,t){t=t||l,e=e||f;var n=this.db.transaction([this.storeName],this.consts.READ_ONLY),r=n.objectStore(this.storeName);return r.getAll?this._getAllNative(n,r,e,t):this._getAllCursor(n,r,e,t),n},_getAllNative:function(e,t,n,r){var o=!1,i=null,e=(e.oncomplete=function(){(o?n:r)(i)},e.onabort=r,e.onerror=r,t.getAll());e.onsuccess=function(e){o=!0,i=e.target.result},e.onerror=r},_getAllCursor:function(e,t,n,r){var o=[],i=!1,s=null,e=(e.oncomplete=function(){(i?n:r)(s)},e.onabort=r,e.onerror=r,t.openCursor());e.onsuccess=function(e){e=e.target.result;e?(o.push(e.value),e.continue()):(i=!0,s=o)},e.onError=r},clear:function(e,t){t=t||l,e=e||f;var n=!1,r=null,o=this.db.transaction([this.storeName],this.consts.READ_WRITE),i=(o.oncomplete=function(){(n?e:t)(r)},o.onabort=t,o.onerror=t,o.objectStore(this.storeName).clear());return i.onsuccess=function(e){n=!0,r=e.target.result},i.onerror=t,o},_addIdPropertyIfNeeded:function(e){void 0===e[this.keyPath]&&(e[this.keyPath]=this._insertIdCount+++Date.now())},getIndexList:function(){return this.store.indexNames},hasIndex:function(e){return this.store.indexNames.contains(e)},normalizeIndexData:function(e){e.keyPath=e.keyPath||e.name,e.unique=!!e.unique,e.multiEntry=!!e.multiEntry},indexComplies:function(i,s){return["keyPath","unique","multiEntry"].every(function(e){if("multiEntry"!=e||void 0!==i[e]||!1!==s[e]){if("keyPath"!=e||"[object Array]"!=Object.prototype.toString.call(s[e]))return s[e]==i[e];var t=s.keyPath,n=i.keyPath;if("string"==typeof n)return t.toString()==n;if("function"!=typeof n.contains&&"function"!=typeof n.indexOf)return!1;if(n.length!==t.length)return!1;for(var r=0,o=t.length;r<o;r++)if(!(n.contains&&n.contains(t[r])||n.indexOf(-1!==t[r])))return!1}return!0})},iterate:function(n,r){var e="desc"==(r=a({index:null,order:"ASC",autoContinue:!0,filterDuplicates:!1,keyRange:null,writeAccess:!1,onEnd:null,onError:l,limit:1/0,offset:0,allowItemRejection:!1},r||{})).order.toLowerCase()?"PREV":"NEXT",o=(r.filterDuplicates&&(e+="_NO_DUPLICATE"),!1),i=this.db.transaction([this.storeName],this.consts[r.writeAccess?"READ_WRITE":"READ_ONLY"]),t=i.objectStore(this.storeName),s=(r.index&&(t=t.index(r.index)),0),t=(i.oncomplete=function(){o?r.onEnd?r.onEnd():n(null):r.onError(null)},i.onabort=r.onError,i.onerror=r.onError,t.openCursor(r.keyRange,this.consts[e]));return t.onerror=r.onError,t.onsuccess=function(e){var t,e=e.target.result;e?r.offset?(e.advance(r.offset),r.offset=0):(t=n(e.value,e,i),r.allowItemRejection&&!1===t||s++,r.autoContinue&&(s+r.offset<r.limit?e.continue():o=!0)):o=!0},i},query:function(e,n){var r=[],o=0;return(n=n||{}).autoContinue=!0,n.writeAccess=!1,n.allowItemRejection=!!n.filter,n.onEnd=function(){e(r,o)},this.iterate(function(e){o++;var t=!n.filter||n.filter(e);return!1!==t&&r.push(e),t},n)},count:function(e,t){var n=(t=a({index:null,keyRange:null},t||{})).onError||l,r=!1,o=null,i=this.db.transaction([this.storeName],this.consts.READ_ONLY),s=(i.oncomplete=function(){(r?e:n)(o)},i.onabort=n,i.onerror=n,i.objectStore(this.storeName)),s=(s=t.index?s.index(t.index):s).count(t.keyRange);return s.onsuccess=function(e){r=!0,o=e.target.result},s.onError=n,i},makeKeyRange:function(e){var t,n=void 0!==e.lower,r=void 0!==e.upper;switch(!0){case void 0!==e.only:t=this.keyRange.only(e.only);break;case n&&r:t=this.keyRange.bound(e.lower,e.upper,e.excludeLower,e.excludeUpper);break;case n:t=this.keyRange.lowerBound(e.lower,e.excludeLower);break;case r:t=this.keyRange.upperBound(e.upper,e.excludeUpper);break;default:throw new Error('Cannot create KeyRange. Provide one or both of "lower" or "upper" value, or an "only" value.')}return t}},i={};function a(e,t){var n,r;for(n in t)(r=t[n])!==i[n]&&r!==e[n]&&(e[n]=r);return e}return e.prototype=t,e.version=t.version,e})?r.call(t,n,t,e):r)&&(e.exports=r)}()},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,function(e,r,t){!function r(o,i,s){function a(t,e){if(!i[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n=i[t]={exports:{}};o[t][0].call(n.exports,function(e){return a(o[t][1][e]||e)},n,n.exports,r,o,i,s)}return i[t].exports}for(var c="function"==typeof require&&require,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,t,n){r.Buffer=e("buffer").Buffer},{buffer:3}],2:[function(e,t,n){"use strict";n.byteLength=function(e){var e=d(e),t=e[0],e=e[1];return 3*(t+e)/4-e},n.toByteArray=function(e){for(var t,n=d(e),r=n[0],n=n[1],o=new u(3*(r+n)/4-n),i=0,s=0<n?r-4:r,a=0;a<s;a+=4)t=c[e.charCodeAt(a)]<<18|c[e.charCodeAt(a+1)]<<12|c[e.charCodeAt(a+2)]<<6|c[e.charCodeAt(a+3)],o[i++]=t>>16&255,o[i++]=t>>8&255,o[i++]=255&t;return 2===n&&(t=c[e.charCodeAt(a)]<<2|c[e.charCodeAt(a+1)]>>4,o[i++]=255&t),1===n&&(t=c[e.charCodeAt(a)]<<10|c[e.charCodeAt(a+1)]<<4|c[e.charCodeAt(a+2)]>>2,o[i++]=t>>8&255,o[i++]=255&t),o},n.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o=[],i=0,s=n-r;i<s;i+=16383)o.push(function(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(a[(r=r)>>18&63]+a[r>>12&63]+a[r>>6&63]+a[63&r]);return o.join("")}(e,i,s<i+16383?s:i+16383));return 1==r?(t=e[n-1],o.push(a[t>>2]+a[t<<4&63]+"==")):2==r&&(t=(e[n-2]<<8)+e[n-1],o.push(a[t>>10]+a[t>>4&63]+a[t<<2&63]+"=")),o.join("")};for(var a=[],c=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,i=r.length;o<i;++o)a[o]=r[o],c[r.charCodeAt(o)]=o;function d(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("=");return[e=-1===e?t:e,e===t?0:4-e%4]}c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},{}],3:[function(O,e,P){!function(e){!function(){"use strict";var C=O("base64-js"),i=O("ieee754"),t=(P.Buffer=l,P.SlowBuffer=function(e){return l.alloc(+(e=+e!=e?0:e))},P.INSPECT_MAX_BYTES=50,2147483647);function d(e){if(t<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return e.__proto__=l.prototype,e}function l(e,t,n){if("number"!=typeof e)return r(e,t,n);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return s(e)}function r(e,t,n){if("string"==typeof e){var r=e,o=t;if(l.isEncoding(o="string"==typeof o&&""!==o?o:"utf8"))return(r=(s=d(i=0|h(r,o))).write(r,o))!==i?s.slice(0,r):s;throw new TypeError("Unknown encoding: "+o)}if(ArrayBuffer.isView(e))return f(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(A(e,ArrayBuffer)||e&&A(e.buffer,ArrayBuffer)){var i=e,r=t,s=n;if(r<0||i.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(i.byteLength<r+(s||0))throw new RangeError('"length" is outside of buffer bounds');return(i=void 0===r&&void 0===s?new Uint8Array(i):void 0===s?new Uint8Array(i,r):new Uint8Array(i,r,s)).__proto__=l.prototype,i}if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');o=e.valueOf&&e.valueOf();if(null!=o&&o!==e)return l.from(o,t,n);var a,c,u=l.isBuffer(a=e)?(0!==(c=d(u=0|p(a.length))).length&&a.copy(c,0,0,u),c):void 0!==a.length?"number"!=typeof a.length||x(a.length)?d(0):f(a):"Buffer"===a.type&&Array.isArray(a.data)?f(a.data):void 0;if(u)return u;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function o(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function s(e){return o(e),d(e<0?0:0|p(e))}function f(e){for(var t=e.length<0?0:0|p(e.length),n=d(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function p(e){if(t<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+t.toString(16)+" bytes");return 0|e}function h(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||A(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=2<arguments.length&&!0===arguments[2];if(!r&&0===n)return 0;for(var o=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return S(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return E(e).length;default:if(o)return r?-1:S(e).length;t=(""+t).toLowerCase(),o=!0}}function n(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function a(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),(n=(n=x(n=+n)?o?0:e.length-1:n)<0?e.length+n:n)>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:c(e,t,n,r,o);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(o?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,n):c(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function c(e,t,n,r,o){var i=1,s=e.length,a=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s/=i=2,a/=2,n/=2}function c(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(o)for(var u=-1,d=n;d<s;d++)if(c(e,d)===c(t,-1===u?0:d-u)){if(d-(u=-1===u?d:u)+1===a)return u*i}else-1!==u&&(d-=d-u),u=-1;else for(d=n=s<n+a?s-a:n;0<=d;d--){for(var l=!0,f=0;f<a;f++)if(c(e,d+f)!==c(t,f)){l=!1;break}if(l)return d}return-1}function g(e,t,n,r){return T(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function R(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,s,a,c,u=e[o],d=null,l=239<u?4:223<u?3:191<u?2:1;if(o+l<=n)switch(l){case 1:u<128&&(d=u);break;case 2:128==(192&(i=e[o+1]))&&127<(c=(31&u)<<6|63&i)&&(d=c);break;case 3:i=e[o+1],s=e[o+2],128==(192&i)&&128==(192&s)&&2047<(c=(15&u)<<12|(63&i)<<6|63&s)&&(c<55296||57343<c)&&(d=c);break;case 4:i=e[o+1],s=e[o+2],a=e[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&65535<(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)&&c<1114112&&(d=c)}null===d?(d=65533,l=1):65535<d&&(r.push((d-=65536)>>>10&1023|55296),d=56320|1023&d),r.push(d),o+=l}var f=r,p=f.length;if(p<=v)return String.fromCharCode.apply(String,f);for(var h="",m=0;m<p;)h+=String.fromCharCode.apply(String,f.slice(m,m+=v));return h}P.kMaxLength=t,(l.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),l.poolSize=8192,l.from=r,l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,l.alloc=function(e,t,n){return t=t,n=n,o(e=e),!(e<=0)&&void 0!==t?"string"==typeof n?d(e).fill(t,n):d(e).fill(t):d(e)},l.allocUnsafe=s,l.allocUnsafeSlow=s,l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(A(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),A(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);if(void 0===t)for(o=t=0;o<e.length;++o)t+=e[o].length;for(var n=l.allocUnsafe(t),r=0,o=0;o<e.length;++o){var i=e[o];if(A(i,Uint8Array)&&(i=l.from(i)),!l.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,r),r+=i.length}return n},l.byteLength=h,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)n(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)n(this,t,t+3),n(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)n(this,t,t+7),n(this,t+1,t+6),n(this,t+2,t+5),n(this,t+3,t+4);return this},l.prototype.toLocaleString=l.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?R(this,0,e):function(e,t,n){var r,o=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":var i=this,s=t,a=n,c=i.length;(!a||a<0||c<a)&&(a=c);for(var u="",d=s=!s||s<0?0:s;d<a;++d)u+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(i[d]);return u;case"utf8":case"utf-8":return R(this,t,n);case"ascii":var l=this,c=t,f=n,p="";f=Math.min(l.length,f);for(var h=c;h<f;++h)p+=String.fromCharCode(127&l[h]);return p;case"latin1":case"binary":var m=this,s=t,v=n,y="";v=Math.min(m.length,v);for(var g=s;g<v;++g)y+=String.fromCharCode(m[g]);return y;case"base64":return b=this,r=n,0===(w=t)&&r===b.length?C.fromByteArray(b):C.fromByteArray(b.slice(w,r));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var b=t,w=n,k=this.slice(b,w),S="",E=0;E<k.length;E+=2)S+=String.fromCharCode(k[E]+256*k[E+1]);return S;default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}.apply(this,arguments)},l.prototype.equals=function(e){if(l.isBuffer(e))return this===e||0===l.compare(this,e);throw new TypeError("Argument must be a Buffer")},l.prototype.inspect=function(){var e="",t=P.INSPECT_MAX_BYTES,e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim();return this.length>t&&(e+=" ... "),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,r,o){if(A(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),(t=void 0===t?0:t)<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(o<=r&&n<=t)return 0;if(o<=r)return-1;if(n<=t)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(i,s),c=this.slice(r,o),u=e.slice(t,n),d=0;d<a;++d)if(c[d]!==u[d]){i=c[d],s=u[d];break}return i<s?-1:s<i?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return a(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return a(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||o<n)&&(n=o),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var i,s,a,c,u,d=!1;;)switch(r){case"hex":var l=this,f=e,p=t,h=n,m=(p=Number(p)||0,l.length-p);(!h||(h=Number(h))>m)&&(h=m),(m=f.length)/2<h&&(h=m/2);for(var v=0;v<h;++v){var y=parseInt(f.substr(2*v,2),16);if(x(y))return v;l[p+v]=y}return v;case"utf8":case"utf-8":return m=t,u=n,T(S(e,(c=this).length-m),c,m,u);case"ascii":return g(this,e,t,n);case"latin1":case"binary":return g(this,e,t,n);case"base64":return c=this,u=t,a=n,T(E(e),c,u,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a=t,s=n,T(function(e,t){for(var n,r,o=[],i=0;i<e.length&&!((t-=2)<0);++i)r=(n=e.charCodeAt(i))>>8,o.push(n%256),o.push(r);return o}(e,(i=this).length-a),i,a,s);default:if(d)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),d=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var v=4096;function u(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function m(e,t,n,r,o,i){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(o<t||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function y(e,t,n,r){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function b(e,t,n,r,o){return t=+t,n>>>=0,o||y(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function w(e,t,n,r,o){return t=+t,n>>>=0,o||y(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){var n=this.length,n=((e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),t<e&&(t=e),this.subarray(e,t));return n.__proto__=l.prototype,n},l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||u(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||u(e,t,this.length);for(var r=this[e+--t],o=1;0<t&&(o*=256);)r+=this[e+--t]*o;return r},l.prototype.readUInt8=function(e,t){return e>>>=0,t||u(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||u(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||u(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||u(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||u(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||u(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||u(e,t,this.length);for(var r=t,o=1,i=this[e+--r];0<r&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readInt8=function(e,t){return e>>>=0,t||u(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||u(e,2,this.length);t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},l.prototype.readInt16BE=function(e,t){e>>>=0,t||u(e,2,this.length);t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||u(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||u(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return e>>>=0,t||u(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||u(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||u(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||u(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||m(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||m(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;0<=--o&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeIntLE=function(e,t,n,r){e=+e,t>>>=0,r||m(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var o=0,i=1,s=0;for(this[t]=255&e;++o<n&&(i*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){e=+e,t>>>=0,r||m(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var o=n-1,i=1,s=0;for(this[t+o]=255&e;0<=--o&&(i*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||m(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeFloatLE=function(e,t,n){return b(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return b(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return w(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return w(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n=n||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),(r=0<r&&r<n?n:r)===n)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length);var o=(r=e.length-t<r-n?e.length-t+n:r)-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var i=o-1;0<=i;--i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return o},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var o;1===e.length&&(o=e.charCodeAt(0),"utf8"===r&&o<128||"latin1"===r)&&(e=o)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");var i;if(!(n<=t))if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(i=t;i<n;++i)this[i]=e;else{var s=l.isBuffer(e)?e:l.from(e,r),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=s[i%a]}return this};var k=/[^+/0-9A-Za-z-_]/g;function S(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],s=0;s<r;++s){if(55295<(n=e.charCodeAt(s))&&n<57344){if(!o){if(56319<n){-1<(t-=3)&&i.push(239,191,189);continue}if(s+1===r){-1<(t-=3)&&i.push(239,191,189);continue}o=n;continue}if(n<56320){-1<(t-=3)&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&-1<(t-=3)&&i.push(239,191,189);if(o=null,n<128){if(--t<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function E(e){return C.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(k,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function T(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function A(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function x(e){return e!=e}}.call(this)}.call(this,O("buffer").Buffer)},{"base64-js":2,buffer:3,ieee754:4}],4:[function(e,t,n){n.read=function(e,t,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,u=c>>1,d=-7,l=n?o-1:0,f=n?-1:1,o=e[t+l];for(l+=f,i=o&(1<<-d)-1,o>>=-d,d+=a;0<d;i=256*i+e[t+l],l+=f,d-=8);for(s=i&(1<<-d)-1,i>>=-d,d+=r;0<d;s=256*s+e[t+l],l+=f,d-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(o?-1:1);s+=Math.pow(2,r),i-=u}return(o?-1:1)*s*Math.pow(2,i-r)},n.write=function(e,t,n,r,o,i){var s,a,c=8*i-o-1,u=(1<<c)-1,d=u>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,p=r?1:-1,i=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-s))<1&&(s--,r*=2),2<=(t+=1<=s+d?l/r:l*Math.pow(2,1-d))*r&&(s++,r/=2),u<=s+d?(a=0,s=u):1<=s+d?(a=(t*r-1)*Math.pow(2,o),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,o),s=0));8<=o;e[n+f]=255&a,f+=p,a/=256,o-=8);for(s=s<<o|a,c+=o;0<c;e[n+f]=255&s,f+=p,s/=256,c-=8);e[n+f-p]|=128*i}},{}]},{},[1])},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,function(e,t,n){var r;!function(){"use strict";var i={}.hasOwnProperty;function s(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var r=typeof n;if("string"==r||"number"==r)e.push(this&&this[n]||n);else if(Array.isArray(n))e.push(s.apply(this,n));else if("object"==r)for(var o in n)i.call(n,o)&&n[o]&&e.push(this&&this[o]||o)}}return e.join(" ")}e.exports?e.exports=s.default=s:void 0!==(r=function(){return s}.apply(t,[]))&&(e.exports=r)}()},function(e){e.exports={"ejs-wrapper":"ejs--de6433374cb30211f10e148b320b2f",ejs:"ejs--7a5f920ceffb2913f6dbda780573cf","ejs--full-ui":"ejs--f3a002bba9836fe4ebfed357a45521","controls-tabs":"ejs--008adea3c1ef33a8fc94892a1e97e6",overlay:"ejs--85a95eb6bf74a40ab61b91a91e5bff","key-setting-popup":"ejs--d169a219343bc32dd4aecc3f6b7f25","loading-info":"ejs--782e3572812f983b3a150eec177391",p1:"ejs--c426dd1d179aa351e6cec47e1d9438",p2:"ejs--31e7e81db48819ee35ec6f50378a2e",p3:"ejs--20d4eb2646d396f558a645dc0574f1",p4:"ejs--4de05306c8b099bdeb4585571ac095",ejs__contextmenu:"ejs--c7957d8666bb6b8fc7c3e9c021aaf8",ad:"ejs--cbcfe0a1421cadac9a04c81d6431d6","close-ad":"ejs--f3a1903d935f6cf720d4a0498db62a","start-game":"ejs--73f9b4e94a7a1fe74e11107d5ab2ef",pulse:"ejs--9bd947b3e6427453595f083d740a7c",ejs__control:"ejs--8732295ca5c4902a060d34706a8146","ejs__tab-focus":"ejs--a83b6c705e103e81a7762d0ed5e64b","ejs__control--pressed":"ejs--b1238136ec472a92297159882cf4b8","icon--pressed":"ejs--ec731619062226d943da67f5d83009","icon--not-pressed":"ejs--dc7068585e3d84fe0e676864c1439e","label--pressed":"ejs--0c6561f9155750b0aeeed6da5da7bf","label--not-pressed":"ejs--13d64e30c1333cc99391af48ddabaa","ejs--video":"ejs--d5f430a99a1619b3434bf58e34a99c",ejs__controls:"ejs--1acedc5ed6816abe96dd27d910fd74",ejs__progress:"ejs--f1aa376719b564cae0e653157cde14",ejs__time:"ejs--90d2780f99bcc76fdb6b0378a7238e",ejs__menu:"ejs--c7bfb2d1b75a40fdaaf90624bea9e7",ejs__volume:"ejs--36ceeeec0df37a9cf4bbe05fa204ec","ejs--hide-controls":"ejs--1b8cb7f2294b1eb5de5238daea3513","ejs--fullscreen-enabled":"ejs--19409fe2057ab935a7e46abb5b4f49",ejs__tooltip:"ejs--74c6d4176d27e37a19d2e9e61de8f4",ejs__menu__container:"ejs--013213afedeeb6878089b1ca1b4e47","ejs-popup":"ejs--c2532bfe04554193cc42b3be753700","ejs__control--forward":"ejs--0b4cdb4057d1a4623e60836ccc6275","ejs__control--back":"ejs--a7ad9de0cb0ca672b6703c50de7db9",ejs__menu__value:"ejs--f91e90fe7cabc875aff9a431bf5389","ejs__tooltip--visible":"ejs--6ea27aa07e60d1d6e4c9782740028a","ejs--menu-open":"ejs--da54136ccf8c6b0b16d98e8b8e8b88","ejs__video-wrapper":"ejs--057800d021995e1347ec07cb748672",portrait:"ejs--64f1256f556fb94454b930cb3ea7f2","game-started":"ejs--7da7949f602347007818e6d192eb23",ejs__progress__buffer:"ejs--f8d706413436fd119cf01aaf5a9d9d","ejs--audio":"ejs--bd0222e58d71b0a304d6037dfcffd5","ejs--loading":"ejs--2521e1257996f264de36e77cc9c5ee",ejs__dialogs:"ejs--d31688f864f56d6426ebbf2217d6ee",ejs__dialog:"ejs--5e71fd80268afbb1d588e40b993508",ejs__cache__container:"ejs--1e0f0672f67d0e96592314c9ed78b0",ejs__loading__container:"ejs--d7e6a6a8f38bfaa256fe5d709a8258","ejs__load-state__container":"ejs--b183f581b5336c4908ad258d3e1cc7",ejs__screenRecord__container:"ejs--b183f581b5336cashrqd258d3e1cc7",ejs__netplay__container:"ejs--158ea9dd34e3e7af2d837f8b05babb",ejs__gamepad__container:"ejs--3f0897a8158ba363a0ee0afe4da7c5","dialog-container":"ejs--38cc09882a55e98c76168dbe838aa0","dialog-title":"ejs--b373c9d5029d49324fb8ac3ece96c1","dialog-content":"ejs--a5e2629abb9a5bcbc8b2c1307922d2","dialog-buttons":"ejs--580e3c22e63f8a1eb29694fd0b141b","btn-cancel":"ejs--ad20569e1449d7b8e99e6465960456","btn-reset":"ejs--ad20569e1449d7b8e99e6465963825","btn-clear":"ejs--ad20569e1449d7b8e99e6468571053","btn-close":"ejs--iehanqurh382hriwqoriuehqr83hq9",tabs:"ejs--8e7922427f460a31935084b7acfb1a",active:"ejs--68d337c212ec6a5bc43125440d422b","tabs-content":"ejs--31eb28817642bb1bfe0a2c422108bb","tabs-panel":"ejs--f932566a0af5314da834324c901978","button-container":"ejs--c233fb69cbef43078bc39e9d1efac8","btn-submit":"ejs--bdb54e9fc47f9805b506b746e897bf","btn-create-room":"ejs--67d03ee7480b871ad6507d6319a839","btn-quit":"ejs--c2d931157456c1d438d40a2f66af2c",set:"ejs--6604c83041a275a78837c452a71dd8","btn-join-room":"ejs--99150e15f962c63c689cadc81ef40d","netplay-player-name":"ejs--71527b6509aa48afce3ce1a11c02f0","netplay-player-name-input":"ejs--7ad35768e3f6b9faf97db01d5b60ae","netplay-player-name-set":"ejs--9c403e5e107a3e4374ba244b636400","netplay-roomlist":"ejs--d6a46533fa6e510a571af5c28b440a","netplay-create-room":"ejs--57ca9b3853cc7de731483cfcc95a59","netplay-room-name-input":"ejs--0885d5e25e19127b6b516014426a1b","netplay-room-password-input":"ejs--25023d28756fdb9dfbbfb6dccb8677","netplay-create-room-set":"ejs--75b3a8d35aacc6424ed7422fdeaaaa","netplay-room":"ejs--eefdf28d69ed2d20f197308981bb61","cheats-add":"ejs--9e670880bb57e824400fa00f09aaad","cheats-list":"ejs--2b4e3c245b7b25dfdac5e09155a68e","cheat-code-input":"ejs--572b0b3a0345a6b01b01a15a02842c","cheat-name-input":"ejs--a7d7f80c8999469c991ea452a85dd9",ejs__widgets:"ejs--952c974392296e7f643d51db380157",ejs__widget:"ejs--0d7e216cf12ae73705b5d5bb0452fc",ejs__widget_controls_toggle:"ejs--666d4296310579687cf3cf3d2cf951",ejs__widget_netplay:"ejs--c0a5e71f6613caab66d6ae15a5a00f","virtual-gamepad":"ejs--2440e3b831017ff8327c939e2a4413",top:"ejs--b8d8b771d0bbb94e2bbd03054f53fd",left:"ejs--c83d70cb63c933edc073c7fe92e32b",buttons:"ejs--6e7015634623fd6a82e6a7d3488c84",center:"ejs--49fa47c86a131e4ca8fb268bfdde89",right:"ejs--7d2b19f77fd0ccabf94dc1ca39ae18",touch:"ejs--d708d9d486f1eca73a593d5c09f8ad",modal:"ejs--eefec939452eb92fad035932d0f47c",modal__overlay:"ejs--f1f43b27384834c8c22c6f81d0c5ae",modal__container:"ejs--c4ee33766a01ed0356c3ec07898e96",modal__header:"ejs--a073f32023da1ced805c5f95a4e81c",modal__footer:"ejs--ed44f59bb8cd49177586b140658c6c",modal__title:"ejs--81470ba5e6a6d68014839ad4d9a977",modal__close:"ejs--c3c85789c2a7f56d8b26dba75b7e1f",modal__content:"ejs--db44f5520e6f4fd0dd34b478bb9ee8",modal__btn:"ejs--319bcec5dee9444e1a2a53d6503b7c","modal__btn-primary":"ejs--eaf3c1cba25d415d92ac48d7db34dd",modal__errmsg:"ejs--940087708c06b6129ce2bfa45f1d89","micromodal-slide":"ejs--bef295f3125e9ba83d4f3677264bae","is-open":"ejs--60c17e0d149099f207b06f27edae6a",mmfadeIn:"ejs--9d7aa2bd5ee276be085e5b2a0bbc2e",mmslideIn:"ejs--8b069266f76099cc6bc220f6ea56cc",mmfadeOut:"ejs--184b7558ffeb569c1790654537477b",mmslideOut:"ejs--379a464ad0e66ea5fc601e5f2fd73e","ejs-switch":"ejs--4c3e63d4005bd8a0468e9c74a35f62","ejs-delete-cheat":"ejs--90bcdd71cd0d2307e9ee0dffa916da","icon--exit-fullscreen":"ejs--2b3dd6e2e26c0f0dc4ac5779dedd5e","ejs--fullscreen-fallback":"ejs--412041671de21945d3e028b6ae84c9","ejs--no-transition":"ejs--33643265135cf89e6c0a0d9866d6f1","ejs__sr-only":"ejs--6f0e996cd15e5fb6be0256918531d7","ejs-fade-in":"ejs--7cadf43f3d9eb17c7e3c36de84973b","dpad-container":"ejs--914358605501b11476e86626b2ff16","dpad-bg":"ejs--be66239219d594001da38f91c9ad02","dpad-front":"ejs--9dbb9be3403878e912527181e2d41b","dpad-1":"ejs--f9c7797bdf05569bdc13b4f2074270","dpad-2":"ejs--2645f3bad105488a313c5e30dab74f","dpad-1-bg":"ejs--a57cf324c8ff108947112e35e589b5","dpad-2-bg":"ejs--4873d94c18140ab195da609b40b71a","dpad-left":"ejs--bd9311b0a4f654af6ab5ba28bcf358","dpad-right":"ejs--704d45ea060cc6809451a0d9d47ad7","dpad-up":"ejs--f0b89ca5b5621659af184c8e012ccb","dpad-down":"ejs--8de361d6b01eaa181f8db4ac3eb7af"}},function(e,t,n){var r;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r=function(){function e(){}function c(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1},this.config(t),"dynamic"===this.options.mode&&(this.options.restOpacity=0),this.id=c.id,c.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}function r(e,t){var n=this;return n.nipples=[],n.idles=[],n.actives=[],n.ids=[],n.pressureIntervals={},n.manager=e,n.id=r.id,r.id+=1,n.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1},n.config(t),"static"!==n.options.mode&&"semi"!==n.options.mode||(n.options.multitouch=!1),n.options.multitouch||(n.options.maxNumberOfNipples=1),n.updateBox(),n.prepareNipples(),n.bindings(),n.begin(),n.nipples}function t(e){var t,r=this;return r.ids={},r.index=0,r.collections=[],r.config(e),r.prepareCollections(),f.bindEvt(window,"resize",function(e){clearTimeout(t),t=setTimeout(function(){var t,n=f.getScroll();r.collections.forEach(function(e){e.forEach(function(e){t=e.el.getBoundingClientRect(),e.position={x:n.x+t.left,y:n.y+t.top}})})},100)}),r.collections}var o,n=!!("ontouchstart"in window),i=!!window.PointerEvent,s=!!window.MSPointerEvent,a={start:"mousedown",move:"mousemove",end:"mouseup"},u={},f=(i?o={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:s?o={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:n?(o={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},u=a):o=a,{distance:function(e,t){var n=t.x-e.x,t=t.y-e.y;return Math.sqrt(n*n+t*t)},angle:function(e,t){var n=t.x-e.x,t=t.y-e.y;return f.degrees(Math.atan2(t,n))},findCoord:function(e,t,n){var r={x:0,y:0};return n=f.radians(n),r.x=e.x-t*Math.cos(n),r.y=e.y-t*Math.sin(n),r},radians:function(e){return e*(Math.PI/180)},degrees:function(e){return e*(180/Math.PI)},bindEvt:function(e,t,n){for(var r,o=t.split(/[ ,]+/g),i=0;i<o.length;i+=1)r=o[i],e.addEventListener?e.addEventListener(r,n,!1):e.attachEvent&&e.attachEvent(r,n)},unbindEvt:function(e,t,n){for(var r,o=t.split(/[ ,]+/g),i=0;i<o.length;i+=1)r=o[i],e.removeEventListener?e.removeEventListener(r,n):e.detachEvent&&e.detachEvent(r,n)},trigger:function(e,t,n){t=new CustomEvent(t,n);e.dispatchEvent(t)},prepareEvent:function(e){return e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e},getScroll:function(){return{x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},applyPosition:function(e,t){t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},getTransitionStyle:function(e,t,n){var r,o=f.configStylePropertyObject(e);for(r in o)if(o.hasOwnProperty(r))if("string"==typeof t)o[r]=t+" "+n;else{for(var i="",s=0,a=t.length;s<a;s+=1)i+=t[s]+" "+n+", ";o[r]=i.slice(0,-2)}return o},getVendorStyle:function(e,t){var n,r=f.configStylePropertyObject(e);for(n in r)r.hasOwnProperty(n)&&(r[n]=t);return r},configStylePropertyObject:function(t){var n={};return n[t]="",["webkit","Moz","o"].forEach(function(e){n[e+t.charAt(0).toUpperCase()+t.slice(1)]=""}),n},extend:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},safeExtend:function(e,t){var n,r={};for(n in e)e.hasOwnProperty(n)&&t.hasOwnProperty(n)?r[n]=t[n]:e.hasOwnProperty(n)&&(r[n]=e[n]);return r},map:function(e,t){if(e.length)for(var n=0,r=e.length;n<r;n+=1)t(e[n]);else t(e)}}),d=(e.prototype.on=function(e,t){var n,r=this,o=e.split(/[ ,]+/g);r._handlers_=r._handlers_||{};for(var i=0;i<o.length;i+=1)n=o[i],r._handlers_[n]=r._handlers_[n]||[],r._handlers_[n].push(t);return r},e.prototype.off=function(e,t){var n=this;return n._handlers_=n._handlers_||{},void 0===e?n._handlers_={}:void 0===t?n._handlers_[e]=null:n._handlers_[e]&&0<=n._handlers_[e].indexOf(t)&&n._handlers_[e].splice(n._handlers_[e].indexOf(t),1),n},e.prototype.trigger=function(e,t){var n,r=this,o=e.split(/[ ,]+/g);r._handlers_=r._handlers_||{};for(var i=0;i<o.length;i+=1)n=o[i],r._handlers_[n]&&r._handlers_[n].length&&r._handlers_[n].forEach(function(e){e.call(r,{type:n,target:r},t)})},e.prototype.config=function(e){this.options=this.defaults||{},e&&(this.options=f.safeExtend(this.options,e))},e.prototype.bindEvt=function(e,t){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[t]=function(){"function"==typeof n["on"+t]?n["on"+t].apply(n,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},f.bindEvt(e,o[t],n._domHandlers_[t]),u[t]&&f.bindEvt(e,u[t],n._domHandlers_[t]),n},e.prototype.unbindEvt=function(e,t){var n=this;return n._domHandlers_=n._domHandlers_||{},f.unbindEvt(e,o[t],n._domHandlers_[t]),u[t]&&f.unbindEvt(e,u[t],n._domHandlers_[t]),delete n._domHandlers_[t],this},c.prototype=new e,(c.constructor=c).id=0,c.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},c.prototype.stylize=function(){var e,t,n;return this.options.dataOnly||(t=this.options.fadeTime+"ms",e=f.getVendorStyle("borderRadius","50%"),t=f.getTransitionStyle("transition","opacity",t),(n={}).el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5"},f.extend(n.el,t),f.extend(n.back,e),f.extend(n.front,e),this.applyStyles(n)),this},c.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var n in e[t])this.ui[t].style[n]=e[t][n];return this},c.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},c.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},c.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},c.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),"function"==typeof e&&e.call(this)},t.options.fadeTime)),t},c.prototype.hide=function(t){var n=this;return n.options.dataOnly||(n.ui.el.style.opacity=n.options.restOpacity,clearTimeout(n.removeTimeout),clearTimeout(n.showTimeout),clearTimeout(n.restTimeout),n.removeTimeout=setTimeout(function(){var e="dynamic"===n.options.mode?"none":"block";n.ui.el.style.display=e,"function"==typeof t&&t.call(n),n.trigger("hidden",n.instance)},n.options.fadeTime),n.options.restJoystick&&n.restPosition()),n},c.prototype.restPosition=function(e){var t=this,n=(t.frontPosition={x:0,y:0},t.options.fadeTime+"ms"),r={},n=(r.front=f.getTransitionStyle("transition",["top","left"],n),{front:{}});n.front={left:t.frontPosition.x+"px",top:t.frontPosition.y+"px"},t.applyStyles(r),t.applyStyles(n),t.restTimeout=setTimeout(function(){"function"==typeof e&&e.call(t),t.restCallback()},t.options.fadeTime)},c.prototype.restCallback=function(){var e={};e.front=f.getTransitionStyle("transition","none",""),this.applyStyles(e),this.trigger("rested",this.instance)},c.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},c.prototype.computeDirection=function(e){var t,n,r,o=e.angle.radian,i=Math.PI/4,s=Math.PI/2;if(i<o&&o<3*i&&!e.lockX?t="up":-i<o&&o<=i&&!e.lockY?t="left":3*-i<o&&o<=-i&&!e.lockX?t="down":e.lockY||(t="right"),e.lockY||(n=-s<o&&o<s?"left":"right"),e.lockX||(r=0<o?"up":"down"),e.force>this.options.threshold){var a={};for(c in this.direction)this.direction.hasOwnProperty(c)&&(a[c]=this.direction[c]);var c,u={};for(c in this.direction={x:n,y:r,angle:t},e.direction=this.direction,a)a[c]===this.direction[c]&&(u[c]=!0);if(u.x&&u.y&&u.angle)return e;u.x&&u.y||this.trigger("plain",e),u.x||this.trigger("plain:"+n,e),u.y||this.trigger("plain:"+r,e),u.angle||this.trigger("dir dir:"+t,e)}return e},r.prototype=new e,(r.constructor=r).id=0,r.prototype.prepareNipples=function(){var e=this,r=e.nipples;r.on=e.on.bind(e),r.off=e.off.bind(e),r.options=e.options,r.destroy=e.destroy.bind(e),r.ids=e.ids,r.id=e.id,r.processOnMove=e.processOnMove.bind(e),r.processOnEnd=e.processOnEnd.bind(e),r.get=function(e){if(void 0===e)return r[0];for(var t=0,n=r.length;t<n;t+=1)if(r[t].identifier===e)return r[t];return!1}},r.prototype.bindings=function(){this.bindEvt(this.options.zone,"start"),this.options.zone.style.touchAction="none",this.options.zone.style.msTouchAction="none"},r.prototype.begin=function(){var e=this.options;"static"===e.mode&&((e=this.createNipple(e.position,this.manager.getIdentifier())).add(),this.idles.push(e))},r.prototype.createNipple=function(e,t){var n,r=this,o=f.getScroll(),i={},s=r.options,a=(e.x&&e.y?i={x:e.x-(o.x+r.box.left),y:e.y-(o.y+r.box.top)}:(e.top||e.right||e.bottom||e.left)&&((a=document.createElement("DIV")).style.display="hidden",a.style.top=e.top,a.style.right=e.right,a.style.bottom=e.bottom,a.style.left=e.left,a.style.position="absolute",s.zone.appendChild(a),n=a.getBoundingClientRect(),s.zone.removeChild(a),i=e,e={x:n.left+o.x,y:n.top+o.y}),new c(r,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:t,position:e,zone:s.zone,frontPosition:{x:0,y:0}}));return s.dataOnly||(f.applyPosition(a.ui.el,i),f.applyPosition(a.ui.front,a.frontPosition)),r.nipples.push(a),r.trigger("added "+a.identifier+":added",a),r.manager.trigger("added "+a.identifier+":added",a),r.bindNipple(a),a},r.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},r.prototype.bindNipple=function(e){function t(e,t){n=e.type+" "+t.id+":"+e.type,r.trigger(n,t)}var n,r=this;e.on("destroyed",r.onDestroyed.bind(r)),e.on("shown hidden rested dir plain",t),e.on("dir:up dir:right dir:down dir:left",t),e.on("plain:up plain:right plain:down plain:left",t)},r.prototype.pressureFn=function(t,n,e){var r=this,o=0;clearInterval(r.pressureIntervals[e]),r.pressureIntervals[e]=setInterval(function(){var e=t.force||t.pressure||t.webkitForce||0;e!==o&&(n.trigger("pressure",e),r.trigger("pressure "+n.identifier+":pressure",e),o=e)}.bind(r),100)},r.prototype.onstart=function(e){var t=this,n=t.options;return e=f.prepareEvent(e),t.updateBox(),f.map(e,function(e){t.actives.length<n.maxNumberOfNipples&&t.processOnStart(e)}),t.manager.bindDocument(),!1},r.prototype.processOnStart=function(t){function e(e){e.trigger("start",e),n.trigger("start "+e.id+":start",e),e.show(),0<i&&n.pressureFn(t,e,e.identifier),n.processOnMove(t)}var n=this,r=n.options,o=n.manager.getIdentifier(t),i=t.force||t.pressure||t.webkitForce||0,s={x:t.pageX,y:t.pageY},a=n.getOrCreate(o,s);a.identifier!==o&&n.manager.removeIdentifier(a.identifier),a.identifier=o;if(0<=(o=n.idles.indexOf(a))&&n.idles.splice(o,1),n.actives.push(a),n.ids.push(a.identifier),"semi"!==r.mode||f.distance(s,a.position)<=r.catchDistance)return e(a),a;a.destroy(),n.processOnStart(t)},r.prototype.getOrCreate=function(e,t){var n,r=this,o=r.options;return/(semi|static)/.test(o.mode)?(n=r.idles[0])?(r.idles.splice(0,1),n):"semi"===o.mode?r.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1):r.createNipple(t,e)},r.prototype.processOnMove=function(e){var t,n,r,o,i,s,a,c=this,u=c.options,d=c.manager.getIdentifier(e),l=c.nipples.get(d);l?(l.identifier=d,a=l.options.size/2,t={x:e.pageX,y:e.pageY},n=f.distance(t,l.position),r=f.angle(t,l.position),o=f.radians(r),i=n/a,a=(t=a<n?f.findCoord(l.position,n=a,r):t).x-l.position.x,s=t.y-l.position.y,u.lockX&&(s=0),u.lockY&&(a=0),l.frontPosition={x:a,y:s},u.dataOnly||f.applyPosition(l.ui.front,l.frontPosition),a={identifier:l.identifier,position:t,force:i,pressure:e.force||e.pressure||e.webkitForce||0,distance:n,angle:{radian:o,degree:r},instance:l,lockX:u.lockX,lockY:u.lockY},(a=l.computeDirection(a)).angle={radian:f.radians(180-r),degree:180-r},l.trigger("move",a),c.trigger("move "+l.id+":move",a)):(console.error("Found zombie joystick with ID "+d),c.manager.removeIdentifier(d))},r.prototype.processOnEnd=function(e){var t=this,n=t.options,e=t.manager.getIdentifier(e),r=t.nipples.get(e),e=t.manager.removeIdentifier(r.identifier);r&&(n.dataOnly||r.hide(function(){"dynamic"===n.mode&&(r.trigger("removed",r),t.trigger("removed "+r.id+":removed",r),t.manager.trigger("removed "+r.id+":removed",r),r.destroy())}),clearInterval(t.pressureIntervals[r.identifier]),r.resetDirection(),r.trigger("end",r),t.trigger("end "+r.id+":end",r),0<=t.ids.indexOf(r.identifier)&&t.ids.splice(t.ids.indexOf(r.identifier),1),0<=t.actives.indexOf(r)&&t.actives.splice(t.actives.indexOf(r),1),/(semi|static)/.test(n.mode)?t.idles.push(r):0<=t.nipples.indexOf(r)&&t.nipples.splice(t.nipples.indexOf(r),1),t.manager.unbindDocument(),/(semi|static)/.test(n.mode))&&(t.manager.ids[e.id]=e.identifier)},r.prototype.onDestroyed=function(e,t){var n=this;0<=n.nipples.indexOf(t)&&n.nipples.splice(n.nipples.indexOf(t),1),0<=n.actives.indexOf(t)&&n.actives.splice(n.actives.indexOf(t),1),0<=n.idles.indexOf(t)&&n.idles.splice(n.idles.indexOf(t),1),0<=n.ids.indexOf(t.identifier)&&n.ids.splice(n.ids.indexOf(t.identifier),1),n.manager.removeIdentifier(t.identifier),n.manager.unbindDocument()},r.prototype.destroy=function(){var e,t=this;for(e in t.unbindEvt(t.options.zone,"start"),t.nipples.forEach(function(e){e.destroy()}),t.pressureIntervals)t.pressureIntervals.hasOwnProperty(e)&&clearInterval(t.pressureIntervals[e]);t.trigger("destroyed",t.nipples),t.manager.unbindDocument(),t.off()},t.prototype=new e,(t.constructor=t).prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var n;return e.collections.every(function(e){return!(n=e.get(t))}),n}},t.prototype.create=function(e){return this.createCollection(e)},t.prototype.createCollection=function(e){e=new r(this,e);return this.bindCollection(e),this.collections.push(e),e},t.prototype.bindCollection=function(e){function t(e,t){n=e.type+" "+t.id+":"+e.type,r.trigger(n,t)}var n,r=this;e.on("destroyed",r.onDestroyed.bind(r)),e.on("shown hidden rested dir plain",t),e.on("dir:up dir:right dir:down dir:left",t),e.on("plain:up plain:right plain:down plain:left",t)},t.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,"move").bindEvt(document,"end"),this.binded=!0)},t.prototype.unbindDocument=function(e){Object.keys(this.ids).length&&!0!==e||(this.unbindEvt(document,"move").unbindEvt(document,"end"),this.binded=!1)},t.prototype.getIdentifier=function(e){var t;return e?void 0===(t=void 0===e.identifier?e.pointerId:e.identifier)&&(t=this.latest||0):t=this.index,void 0===this.ids[t]&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]},t.prototype.removeIdentifier=function(e){var t,n={};for(t in this.ids)if(this.ids[t]===e){n.id=t,n.identifier=this.ids[t],delete this.ids[t];break}return n},t.prototype.onmove=function(e){return this.onAny("move",e),!1},t.prototype.onend=function(e){return this.onAny("end",e),!1},t.prototype.oncancel=function(e){return this.onAny("end",e),!1},t.prototype.onAny=function(e,t){var n,r=this,o="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=f.prepareEvent(t);return f.map(t,function(e){n=r.getIdentifier(e),f.map(r.collections,function(e,t,n){0<=n.ids.indexOf(t)&&(n[o](e),e._found_=!0)}.bind(null,e,n)),e._found_||r.removeIdentifier(n)}),!1},t.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(e){e.destroy()}),e.off()},t.prototype.onDestroyed=function(e,t){if(this.collections.indexOf(t)<0)return!1;this.collections.splice(this.collections.indexOf(t),1)},new t);return{create:function(e){return d.create(e)},factory:d}},"object"==o(t)&&void 0!==e?e.exports=r():void 0!==(t="function"==typeof(r=r)?r.apply(t,[]):r)&&(e.exports=t)},null,function(e,i,Ve){"use strict";!function(v,De,je){function Be(e){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(){var s=this,o=new e,n=(s.chunks={},s.users={},s.readAsArrayBuffer=function(t,n,e){var r={file:t,earlyCallback:function(e){n(a(e,{currentPosition:-1}))},extra:e||{userid:0}};t.extra&&Object.keys(t.extra).length&&Object.keys(t.extra).forEach(function(e){r.extra[e]=t.extra[e]}),o.readAsArrayBuffer(s,r)},s.getNextChunk=function(e,t,n){void 0!==e.currentPosition&&(r=e.currentPosition,e=e.uuid);var r,o,i=s.chunks[e];i&&((o=i[r=(void 0!==n?(s.users[n+""]||(s.users[n+""]={fileUUID:e,userid:n,currentPosition:-1}),void 0!==r&&(s.users[n+""].currentPosition=r),s.users[n+""].currentPosition++,s.users[n+""]):(void 0!==r&&(s.chunks[e].currentPosition=r),s.chunks[e].currentPosition++,s.chunks[e])).currentPosition])?(o=a(o),void 0!==n&&(o.remoteUserId=n+""),o.start&&s.onBegin(o),o.end&&s.onEnd(o),s.onProgress(o),s.convertToArrayBuffer(o,function(e){o.currentPosition!=o.maxChunks?t(e,!1):t(e,!0)})):(delete s.chunks[e],s.convertToArrayBuffer({chunkMissing:!0,currentPosition:r,uuid:e},t)))},new t(s));function a(e,t){if(null==e||"object"!=Be(e))return e;if(e.constructor!=Object&&e.constructor!=Array)return e;if(e.constructor==Date||e.constructor==RegExp||e.constructor==Function||e.constructor==String||e.constructor==Number||e.constructor==Boolean)return new e.constructor(e);for(var n in t=t||new e.constructor,e)t[n]=void 0===t[n]?a(e[n],null):t[n];return t}s.addChunk=function(e,t){e&&n.receive(e,function(e){s.convertToArrayBuffer({readyForNextChunk:!0,currentPosition:e.currentPosition,uuid:e.uuid},t)})},s.chunkMissing=function(e){delete n.chunks[e.uuid],delete n.chunksWaiters[e.uuid]},s.onBegin=function(){},s.onEnd=function(){},s.onProgress=function(){},s.convertToObject=r.ConvertToObject,s.convertToArrayBuffer=r.ConvertToArrayBuffer,s.setMultipleUsers=function(){}}function e(){this.readAsArrayBuffer=function(t,n){var e,o,i,s,a,c,u,d,l,f,p,h,r=n.earlyCallback;delete n.earlyCallback,o=(o=function(e){t.chunks[e.uuid]||(t.chunks[e.uuid]={currentPosition:-1}),n.extra=n.extra||{userid:0},e.userid=n.userid||n.extra.userid||0,e.extra=n.extra,(t.chunks[e.uuid][e.currentPosition]=e).end&&r&&(r(e.uuid),r=null),200<e.maxChunks&&200==e.currentPosition&&r&&(r(e.uuid),r=null)})||function(e){postMessage(e)},(i=(e=n).file).uuid||(i.uuid=(100*Math.random()).toString().replace(/\./g,"")),s=e.chunkSize||15e3,e.extra&&e.extra.chunkSize&&(s=e.extra.chunkSize),c=0,e=s,u=Math.floor(Math.min(1e8,e)/s)*s,d=Math.ceil(i.size/s),i.maxChunks=d,f=[],o({currentPosition:l=0,uuid:i.uuid,maxChunks:d,size:i.size,name:i.name,type:i.type,lastModifiedDate:(i.lastModifiedDate||new Date).toString(),start:!0}),(h=new FileReader).onloadend=function(e){if(e.target.readyState==FileReader.DONE){i.name;var t=e.target.result;a=Math.ceil(t.byteLength/s);for(var n=0;n<a;n++){var r=n*s;f[l]=t.slice(r,Math.min(r+s,t.byteLength)),o({uuid:i.uuid,buffer:f[l],currentPosition:l,maxChunks:d,size:i.size,name:i.name,lastModifiedDate:(i.lastModifiedDate||new Date).toString(),type:i.type}),l++}(++c+1)*u<i.size?(p=i.slice(c*u,(c+1)*u),h.readAsArrayBuffer(p)):c*u<i.size?(p=i.slice(c*u,i.size),h.readAsArrayBuffer(p)):(i.url=URL.createObjectURL(i),o({currentPosition:l,uuid:i.uuid,maxChunks:d,size:i.size,name:i.name,lastModifiedDate:(i.lastModifiedDate||new Date).toString(),url:URL.createObjectURL(i),type:i.type,end:!0}))}},l+=1,p=i.slice(c*u,(c+1)*u),h.readAsArrayBuffer(p)}}function Fe(){var i=this,s=function(){};function n(e,n,t){e=e||function(){};var r,o=document.createElement("input");o.type="file",n&&(o.multiple=!0),t&&(o.webkitdirectory=!0),o.accept=i.accept,o.onclick=function(){o.clickStarted=!0},document.body.onfocus=function(){setTimeout(function(){o.clickStarted&&(o.clickStarted=!1,o.value||s())},500)},o.onchange=function(){var t;if(n)return o.files.length?(t=[],Array.from(o.files).forEach(function(e){e.url=e.webkitRelativePath,t.push(e)}),void e(t)):void console.error("No file selected.");o.files[0]?(e(o.files[0]),o.parentNode.removeChild(o)):console.error("No file selected.")},o.style.display="none",(document.body||document.documentElement).appendChild(o),"function"==typeof(t=o).click?t.click():"function"==typeof t.change?t.change():(void 0!==document.createEvent("Event")&&"function"==typeof(r=document.createEvent("Event")).initEvent&&"function"==typeof t.dispatchEvent?r.initEvent("click",!0,!0):r=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}),t.dispatchEvent(r))}i.selectSingleFile=function(e,t){t&&(s=t),n(e)},i.selectMultipleFiles=function(e,t){t&&(s=t),n(e,!0)},i.selectDirectory=function(e,t){t&&(s=t),n(e,!0,!0)},i.accept="*.*"}function t(s){var a=this;a.chunks={},a.chunksWaiters={},a.receive=function t(n,r){var o,i,e;n.uuid?(n.start&&!a.chunks[n.uuid]&&(a.chunks[n.uuid]={},s.onBegin)&&s.onBegin(n),!n.end&&n.buffer&&(a.chunks[n.uuid][n.currentPosition]=n.buffer),n.end&&(o=a.chunks[n.uuid],i=[],Object.keys(o).forEach(function(e,t){i.push(o[e])}),(e=qe(e=new Blob(i,{type:n.type}),n)).url=URL.createObjectURL(e),e.uuid=n.uuid,e.size||console.error("Something went wrong. Blob Size is 0."),s.onEnd&&s.onEnd(e),delete a.chunks[n.uuid],delete a.chunksWaiters[n.uuid]),n.buffer&&s.onProgress&&s.onProgress(n),n.end||(r(n),a.chunksWaiters[n.uuid]=function(){setTimeout(function e(){n.buffer&&a.chunks[n.uuid]&&(n.currentPosition==n.maxChunks||a.chunks[n.uuid][n.currentPosition]||(r(n),setTimeout(e,5e3)))},5e3)},a.chunksWaiters[n.uuid]())):s.convertToObject(n,function(e){t(e)})}}var r={ConvertToArrayBuffer:function(e,t){o.pack(e,function(e){t(e.buffer)})},ConvertToObject:function(e,t){o.unpack(e,t)}};function qe(e,t){if(e=e||{},t)for(var n in t)try{e[n]=t[n]}catch(e){}return e}function y(e,t){var n,r,o=0,i=e.getUint8(t,!1),s=(t+=g,i!==k.ARRAY&&i!==k.OBJECT||(c=e.getUint16(t,!1),t+=b),n=e.getUint32(t,!1),t+=w,S[i]),a=null===s?0:window[s+"Array"].BYTES_PER_ELEMENT;switch(i){case k.NULL:case k.UNDEFINED:p=null;break;case k.STRING:for(var c=n/a,u=[],o=0;o<c;o++){var d=e.getUint16(t,!1);t+=a,u.push(String.fromCharCode(d))}p=u.join("");break;case k.NUMBER:p=e.getFloat64(t,!1),t+=a;break;case k.BOOLEAN:p=1===e.getUint8(t,!1),t+=a;break;case k.INT8ARRAY:case k.INT16ARRAY:case k.INT32ARRAY:case k.UINT8ARRAY:case k.UINT16ARRAY:case k.UINT32ARRAY:case k.FLOAT32ARRAY:case k.FLOAT64ARRAY:case k.ARRAYBUFFER:r=e.buffer.slice(t,t+n),t+=n,p=i===k.ARRAYBUFFER?r:new window[s+"Array"](r);break;case k.BLOB:var l,f,p=window.Blob?(t=(f=y(e,(l=y(e,t)).cursor)).cursor,new Blob([f.value],{type:l.value})):(r=e.buffer.slice(t,t+n),t+=n,new v(r));break;case k.ARRAY:for(p=[],o=0;o<c;o++)t=(r=y(e,t)).cursor,p.push(r.value);break;case k.OBJECT:for(p={},o=0;o<c;o++){var h=y(e,t),m=y(e,h.cursor);t=m.cursor,p[h.value]=m.value}break;default:throw"TypeError: Type not supported."}return{value:p,cursor:t}}function f(e,o){for(var i=e.length,s=[],a=0,c=0,t=0;t<e.length;t++)!function(r){n(e[r],function(e){if(c+=(s[r]=e)[0].header_size+e[0].byte_length,++a===i){for(var t=[],n=0;n<s.length;n++)t=t.concat(s[n]);o(t,c)}})}(t)}var g=Uint8Array.BYTES_PER_ELEMENT,b=Uint16Array.BYTES_PER_ELEMENT,w=Uint32Array.BYTES_PER_ELEMENT,k={NULL:0,UNDEFINED:1,STRING:2,NUMBER:3,BOOLEAN:4,ARRAY:5,OBJECT:6,INT8ARRAY:7,INT16ARRAY:8,INT32ARRAY:9,UINT8ARRAY:10,UINT16ARRAY:11,UINT32ARRAY:12,FLOAT32ARRAY:13,FLOAT64ARRAY:14,ARRAYBUFFER:15,BLOB:16,FILE:16,BUFFER:17},S=[null,null,"Uint16","Float64","Uint8",null,null,"Int8","Int16","Int32","Uint8","Uint16","Uint32","Float32","Float64","Uint8","Uint8","Uint8"],n=function(n,r){var o=g+w,e=0,i=0,t=n,s=function(e){var t=void 0;if(void 0===e)t=k.UNDEFINED;else if(null===e)t=k.NULL;else{var n=e.constructor.name,r=e.constructor.toString().match(/\w+/g)[1];if(void 0!==n&&void 0!==k[n.toUpperCase()])t=k[n.toUpperCase()];else if(void 0!==r&&void 0!==k[r.toUpperCase()])t=k[r.toUpperCase()];else switch(Be(e)){case"string":t=k.STRING;break;case"number":t=k.NUMBER;break;case"boolean":t=k.BOOLEAN;break;case"object":e instanceof Array?t=k.ARRAY:e instanceof Int8Array?t=k.INT8ARRAY:e instanceof Int16Array?t=k.INT16ARRAY:e instanceof Int32Array?t=k.INT32ARRAY:e instanceof Uint8Array?t=k.UINT8ARRAY:e instanceof Uint16Array?t=k.UINT16ARRAY:e instanceof Uint32Array?t=k.UINT32ARRAY:e instanceof Float32Array?t=k.FLOAT32ARRAY:e instanceof Float64Array?t=k.FLOAT64ARRAY:e instanceof ArrayBuffer?t=k.ARRAYBUFFER:e instanceof Blob?t=k.BLOB:e instanceof v?t=k.BUFFER:e instanceof Object&&(t=k.OBJECT)}}return t}(n),a=null==S[s]?0:window[S[s]+"Array"].BYTES_PER_ELEMENT;switch(s){case k.UNDEFINED:case k.NULL:break;case k.NUMBER:case k.BOOLEAN:e=a;break;case k.STRING:e+=(i=n.length)*a;break;case k.INT8ARRAY:case k.INT16ARRAY:case k.INT32ARRAY:case k.UINT8ARRAY:case k.UINT16ARRAY:case k.UINT32ARRAY:case k.FLOAT32ARRAY:case k.FLOAT64ARRAY:e+=(i=n.length)*a;break;case k.ARRAY:return void f(n,function(e,t){r([{type:s,length:n.length,header_size:o+b,byte_length:t,value:null}].concat(e))});case k.OBJECT:var c,u=[];for(c in n)n.hasOwnProperty(c)&&(u.push(c),u.push(n[c]),i++);return void f(u,function(e,t){r([{type:s,length:i,header_size:o+b,byte_length:t,value:null}].concat(e))});case k.ARRAYBUFFER:e+=n.byteLength;break;case k.BLOB:var d=n.type,l=new FileReader;return l.onload=function(e){f([d,e.target.result],function(e,t){r([{type:s,length:i,header_size:o,byte_length:t,value:null}].concat(e))})},l.onerror=function(e){throw"FileReader Error: "+e},void l.readAsArrayBuffer(n);case k.BUFFER:e+=n.length;break;default:throw'TypeError: Type "'+n.constructor.name+'" not supported.'}r([{type:s,length:i,header_size:o,byte_length:e,value:t}].concat([]))},o={pack:function(e,t){try{n(e,function(e){t(function(e){for(var t=0,n=0,r=0,o=new ArrayBuffer(e[0].byte_length+e[0].header_size),i=new DataView(o),n=0;n<e.length;n++){e[n].header_size;var s=e[n].type,a=e[n].length,c=e[n].value,u=e[n].byte_length,d=S[s],l=null===d?0:window[d+"Array"].BYTES_PER_ELEMENT;switch(s===k.BUFFER?i.setUint8(t,k.BLOB,!1):i.setUint8(t,s,!1),t+=g,s!==k.ARRAY&&s!==k.OBJECT||(i.setUint16(t,a,!1),t+=b),i.setUint32(t,u,!1),t+=w,s){case k.NULL:case k.UNDEFINED:break;case k.STRING:for(r=0;r<a;r++,t+=l)i.setUint16(t,c.charCodeAt(r),!1);break;case k.NUMBER:case k.BOOLEAN:i["set"+d](t,c,!1),t+=l;break;case k.INT8ARRAY:case k.INT16ARRAY:case k.INT32ARRAY:case k.UINT8ARRAY:case k.UINT16ARRAY:case k.UINT32ARRAY:case k.FLOAT32ARRAY:case k.FLOAT64ARRAY:new Uint8Array(i.buffer,t,u).set(new Uint8Array(c.buffer)),t+=u;break;case k.ARRAYBUFFER:case k.BUFFER:new Uint8Array(i.buffer,t,u).set(new Uint8Array(c)),t+=u;break;case k.BLOB:case k.ARRAY:case k.OBJECT:break;default:throw"TypeError: Unexpected type found."}}return i}(e))})}catch(e){throw e}},unpack:function(e,t){try{t(function(e){e=e instanceof DataView?e:new DataView(e);return y(e,0).value}(e))}catch(e){throw e}}};i.a=function(D,j){let B;function n(i,e){function s(e){return!e.audio&&!e.video&&!e.screen&&e.data}var t="",t=(t=(t=(t=(t+="?coreVer="+i.coreVer+"&userid="+i.userid)+("&sessionid="+i.sessionid))+("&msgEvent="+i.socketMessageEvent))+("&socketCustomEvent="+i.socketCustomEvent))+("&autoCloseEntireSession="+!!i.autoCloseEntireSession);if(!0===i.session.broadcast&&(t+="&oneToMany=true"),t+="&maxParticipantsAllowed="+i.maxParticipantsAllowed,i.enableScalableBroadcast&&(t=t+"&enableScalableBroadcast=true"+("&maxRelayLimitPerUser="+(i.maxRelayLimitPerUser||2))),t+="&extra="+JSON.stringify(i.extra||{}),i.socketCustomParameters&&(t+=i.socketCustomParameters),i.socketURL||(i.socketURL="/"),"/"!=i.socketURL.substr(i.socketURL.length-1,1))throw'"socketURL" MUST end with a slash.';i.enableLogs&&("/"==i.socketURL?console.info("socket.io url is: ",location.origin+"/"):console.info("socket.io url is: ",i.socketURL)),i.socket=B(i.socketURL+t);var a=i.multiPeersHandler;function c(e,t){i.peersBackup[e]||(i.peersBackup[e]={userid:e,extra:{}}),i.peersBackup[e].extra=t}i.socket.on("extra-data-updated",function(e,t){i.peers[e]&&(i.peers[e].extra=t,i.onExtraDataUpdated({userid:e,extra:t}),c(e,t))}),i.socket.on(i.socketMessageEvent,function e(t){var n,r,o;t.remoteUserId==i.userid&&(i.peers[t.sender]&&i.peers[t.sender].extra!=t.message.extra&&(i.peers[t.sender].extra=t.extra,i.onExtraDataUpdated({userid:t.sender,extra:t.extra}),c(t.sender,t.extra)),t.message.streamSyncNeeded&&i.peers[t.sender]?(o=i.streamEvents[t.message.streamid])&&o.stream&&("ended"===(n=t.message.action)||"inactive"===n||"stream-removed"===n?(i.peersBackup[o.userid]&&(o.extra=i.peersBackup[o.userid].extra),i.onstreamended(o)):(r="both"!=t.message.type?t.message.type:null,"function"==typeof o.stream[n]&&o.stream[n](r))):"dropPeerConnection"!==t.message?t.message.allParticipants?(-1===t.message.allParticipants.indexOf(t.sender)&&t.message.allParticipants.push(t.sender),t.message.allParticipants.forEach(function(e){a[i.peers[e]?"renegotiatePeer":"createNewPeer"](e,{localPeerSdpConstraints:{OfferToReceiveAudio:i.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:i.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:i.session.oneway?!!i.session.audio:i.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:i.session.oneway?!!i.session.video||!!i.session.screen:i.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!i.session.oneway||"one-way"===i.direction,isDataOnly:s(i.session)})})):t.message.newParticipant?t.message.newParticipant==i.userid||i.peers[t.message.newParticipant]||a.createNewPeer(t.message.newParticipant,t.message.userPreferences||{localPeerSdpConstraints:{OfferToReceiveAudio:i.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:i.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:i.session.oneway?!!i.session.audio:i.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:i.session.oneway?!!i.session.video||!!i.session.screen:i.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!i.session.oneway||"one-way"===i.direction,isDataOnly:s(i.session)}):t.message.readyForOffer&&(i.attachStreams.length&&(i.waitingForLocalMedia=!1),i.waitingForLocalMedia)?setTimeout(function(){e(t)},1):t.message.newParticipationRequest&&t.sender!==i.userid?(i.peers[t.sender]&&i.deletePeer(t.sender),o={extra:t.extra||{},localPeerSdpConstraints:t.message.remotePeerSdpConstraints||{OfferToReceiveAudio:i.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:i.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:t.message.localPeerSdpConstraints||{OfferToReceiveAudio:i.session.oneway?!!i.session.audio:i.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:i.session.oneway?!!i.session.video||!!i.session.screen:i.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:void 0!==t.message.isOneWay?t.message.isOneWay:!!i.session.oneway||"one-way"===i.direction,isDataOnly:void 0!==t.message.isDataOnly?t.message.isDataOnly:s(i.session),dontGetRemoteStream:void 0!==t.message.isOneWay?t.message.isOneWay:!!i.session.oneway||"one-way"===i.direction,dontAttachLocalStream:!!t.message.dontGetRemoteStream,connectionDescription:t,successCallback:function(){}},i.onNewParticipant(t.sender,o)):(t.message.changedUUID&&i.peers[t.message.oldUUID]&&(i.peers[t.message.newUUID]=i.peers[t.message.oldUUID],delete i.peers[t.message.oldUUID]),t.message.userLeft?(a.onUserLeft(t.sender),t.message.autoCloseEntireSession&&i.leave()):a.addNegotiatedMessage(t.message,t.sender)):i.deletePeer(t.sender))});var n=!1;i.socket.resetProps=function(){n=!1},i.socket.on("connect",function(){n||(n=!0,i.enableLogs&&console.info("socket.io connection is opened."),setTimeout(function(){i.socket.emit("extra-data-updated",i.extra)},1e3),e&&e(i.socket))}),i.socket.on("disconnect",function(){i.enableLogs&&console.warn("socket.io connection is closed"),i.close()}),i.socket.on("user-disconnected",function(e){e!==i.userid&&(i.onUserStatusChanged({userid:e,status:"offline",extra:i.peers[e]&&i.peers[e].extra||{}}),i.deletePeer(e))}),i.socket.on("user-connected",function(e){e!==i.userid&&i.onUserStatusChanged({userid:e,status:"online",extra:i.peers[e]&&i.peers[e].extra||{}})}),i.socket.on("closed-entire-session",function(e,t){i.leave(),i.onEntireSessionClosed({sessionid:e,userid:e,extra:t})}),i.socket.on("userid-already-taken",function(e,t){i.onUserIdAlreadyTaken(e,t)}),i.socket.on("logs",function(e){i.enableLogs&&console.debug("server-logs",e)}),i.socket.on("number-of-broadcast-viewers-updated",function(e){i.onNumberOfBroadcastViewersUpdated(e)}),i.socket.on("set-isInitiator-true",function(e){e==i.sessionid&&(i.isInitiator=!0)})}function U(o){var i=this,r=["getAllParticipants","getLength","selectFirst","streams","send","forEach"];function s(){o.fbr=new Ue,o.fbr.onProgress=function(e){o.onFileProgress(e)},o.fbr.onBegin=function(e){o.onFileStart(e)},o.fbr.onEnd=function(e){o.onFileEnd(e)}}o.peers={getLength:function(){var e,t=0;for(e in this)-1==r.indexOf(e)&&t++;return t},selectFirst:function(){var e,t;for(t in this)-1==r.indexOf(t)&&(e=this[t]);return e},getAllParticipants:function(e){var t,n=[];for(t in this)-1==r.indexOf(t)&&t!=e&&n.push(t);return n},forEach:function(t){this.getAllParticipants().forEach(function(e){t(o.peers[e])})},send:function(t,e){var n=this;if(!Y(t.size)&&!Y(t.type)){if(o.enableFileSharing)return void i.shareFile(t,e);"string"!=typeof t&&(t=JSON.stringify(t))}if("text"===t.type||t instanceof ArrayBuffer||t instanceof DataView){if("text"===t.type&&(t=JSON.stringify(t)),e){var r=o.peers[e];if(r)return r.channels.length?void r.channels.forEach(function(e){e.send(t)}):(o.peers[e].createDataChannel(),o.renegotiate(e),void setTimeout(function(){n.send(t,e)},3e3))}this.getAllParticipants().forEach(function(e){n[e].channels.length?n[e].channels.forEach(function(e){e.send(t)}):(o.peers[e].createDataChannel(),o.renegotiate(e),setTimeout(function(){n[e].channels.forEach(function(e){e.send(t)})},3e3))})}else Oe.send({text:t,channel:this,connection:o,remoteUserId:e})}},this.uuid=o.userid,this.getLocalConfig=function(e,n,t){return{streamsToShare:(t=t||{}).streamsToShare||{},rtcMultiConnection:o,connectionDescription:t.connectionDescription,userid:n,localPeerSdpConstraints:t.localPeerSdpConstraints,remotePeerSdpConstraints:t.remotePeerSdpConstraints,dontGetRemoteStream:!!t.dontGetRemoteStream,dontAttachLocalStream:!!t.dontAttachLocalStream,renegotiatingPeer:!!t.renegotiatingPeer,peerRef:t.peerRef,channels:t.channels||[],onLocalSdp:function(e){i.onNegotiationNeeded(e,n)},onLocalCandidate:function(e){(e=we.processCandidates(o,e))&&i.onNegotiationNeeded(e,n)},remoteSdp:e,onDataChannelMessage:function(e){var t;!o.fbr&&o.enableFileSharing&&s(),"string"!=typeof e&&o.enableFileSharing?(t=this,e instanceof ArrayBuffer||e instanceof DataView?o.fbr.convertToObject(e,function(e){t.onDataChannelMessage(e)}):e.readyForNextChunk?o.fbr.getNextChunk(e,function(t,e){o.peers[n].channels.forEach(function(e){e.send(t)})},n):e.chunkMissing?o.fbr.chunkMissing(e):o.fbr.addChunk(e,function(e){o.peers[n].peer.channel.send(e)})):i.onDataChannelMessage(e,n)},onDataChannelError:function(e){i.onDataChannelError(e,n)},onDataChannelOpened:function(e){i.onDataChannelOpened(e,n)},onDataChannelClosed:function(e){i.onDataChannelClosed(e,n)},onRemoteStream:function(e){o.peers[n]&&o.peers[n].streams.push(e),i.onGettingRemoteMedia(e,n)},onRemoteStreamRemoved:function(e){i.onRemovingRemoteMedia(e,n)},onPeerStateChanged:function(e){i.onPeerStateChanged(e),"new"===e.iceConnectionState&&i.onNegotiationStarted(n,e),"connected"===e.iceConnectionState&&i.onNegotiationCompleted(n,e),-1!==e.iceConnectionState.search(/closed|failed/gi)&&(i.onUserLeft(n),i.disconnectWith(n))}}},this.createNewPeer=function(e,t){var n;o.maxParticipantsAllowed<=o.getAllParticipants().length||(t=t||{},o.isInitiator&&o.session.audio&&"two-way"===o.session.audio&&!t.streamsToShare&&(t.isOneWay=!1,t.isDataOnly=!1,t.session=o.session),t.isOneWay||t.isDataOnly?(t=o.setUserPreferences(t,e),n=this.getLocalConfig(null,e,t),o.peers[e]=new me(n)):(t.isOneWay=!0,this.onNegotiationNeeded({enableMedia:!0,userPreferences:t},e)))},this.createAnsweringPeer=function(e,t,n){n=o.setUserPreferences(n||{},t);e=this.getLocalConfig(e,t,n);o.peers[t]=new me(e)},this.renegotiatePeer=function(e,t,n){o.peers[e]?((t=t||{}).renegotiatingPeer=!0,t.peerRef=o.peers[e].peer,t.channels=o.peers[e].channels,n=this.getLocalConfig(n,e,t),o.peers[e]=new me(n)):o.enableLogs&&console.error("Peer ("+e+") does not exist. Renegotiation skipped.")},this.replaceTrack=function(t,n,r){if(!o.peers[n])throw"This peer ("+n+") does not exist.";var e=o.peers[n].peer;e.getSenders&&"function"==typeof e.getSenders&&e.getSenders().length?e.getSenders().forEach(function(e){r&&"video"===e.track.kind&&(o.peers[n].peer.lastVideoTrack=e.track,e.replaceTrack(t)),r||"audio"!==e.track.kind||(o.peers[n].peer.lastAudioTrack=e.track,e.replaceTrack(t))}):(console.warn("RTPSender.replaceTrack is NOT supported."),this.renegotiatePeer(n))},this.onNegotiationNeeded=function(e,t){},this.addNegotiatedMessage=function(e,t){var n;e.type&&e.sdp?("answer"==e.type&&o.peers[t]&&o.peers[t].addRemoteSdp(e),"offer"==e.type&&(e.renegotiatingPeer?this.renegotiatePeer(t,null,e):this.createAnsweringPeer(e,t)),o.enableLogs&&console.log("Remote peer's sdp:",e.sdp)):e.candidate?(o.peers[t]&&o.peers[t].addRemoteCandidate(e),o.enableLogs&&console.log("Remote peer's candidate pairs:",e.candidate)):(e.enableMedia&&(o.session=e.userPreferences.session||o.session,o.session.oneway&&o.attachStreams.length&&(o.attachStreams=[]),e.userPreferences.isDataOnly&&o.attachStreams.length&&(o.attachStreams.length=[]),n={},o.attachStreams.forEach(function(e){n[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}}),e.userPreferences.streamsToShare=n,i.onNegotiationNeeded({readyForOffer:!0,userPreferences:e.userPreferences},t)),e.readyForOffer&&o.onReadyForOffer(t,e.userPreferences))},this.onGettingRemoteMedia=function(e,t){},this.onRemovingRemoteMedia=function(e,t){},this.onGettingLocalMedia=function(e){},this.onLocalMediaError=function(e,t){o.onMediaError(e,t)},this.shareFile=function(e,n){s(),o.fbr.readAsArrayBuffer(e,function(t){var e=o.getAllParticipants();(e=n?[n]:e).forEach(function(e){o.fbr.getNextChunk(t,function(t){o.peers[e].channels.forEach(function(e){e.send(t)})},e)})},{userid:o.userid,chunkSize:"Firefox"===DetectRTC.browser.name?15e3:o.chunkSize||0})};var n=new Te(o);this.onDataChannelMessage=function(e,t){n.receive(JSON.parse(e),t,o.peers[t]?o.peers[t].extra:{})},this.onDataChannelClosed=function(e,t){e.userid=t,e.extra=o.peers[t]?o.peers[t].extra:{},o.onclose(e)},this.onDataChannelError=function(e,t){e.userid=t,event.extra=o.peers[t]?o.peers[t].extra:{},o.onerror(e)},this.onDataChannelOpened=function(e,t){o.peers[t].channels.length?o.peers[t].channels=[e]:(o.peers[t].channels.push(e),o.onopen({userid:t,extra:o.peers[t]?o.peers[t].extra:{},channel:e}))},this.onPeerStateChanged=function(e){o.onPeerStateChanged(e)},this.onNegotiationStarted=function(e,t){},this.onNegotiationCompleted=function(e,t){},this.getRemoteStreams=function(e){return e=e||o.peers.getAllParticipants()[0],o.peers[e]?o.peers[e].streams:[]}}function F(e,t,n){"undefined"!=typeof CustomEvent&&(t=new CustomEvent(t,{arguments:n,__exposedProps__:n}),e.dispatchEvent(t))}function q(t,n){n.stream&&n.stream&&n.stream.addEventListener&&(n.stream.addEventListener("mute",function(e){(e=t.streamEvents[n.streamid]).session={audio:"audio"===e.muteType,video:"video"===e.muteType},t.onmute(e)},!1),n.stream.addEventListener("unmute",function(e){(e=t.streamEvents[n.streamid]).session={audio:"audio"===e.unmuteType,video:"video"===e.unmuteType},t.onunmute(e)},!1))}function f(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var e=window.crypto.getRandomValues(new Uint32Array(3)),t="",n=0,r=e.length;n<r;n++)t+=e[n].toString(36);return t}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}function V(n,t,r){if(r.autoCreateMediaElement){var o,e=!1,i=(S(n,"video").length||n.isVideo||n.isScreen||(e=!0),"Firefox"===DetectRTC.browser.name&&(r.session.video||r.session.screen)&&(e=!1),document.createElement(e?"audio":"video"));i.srcObject=n;try{i.setAttributeNode(document.createAttribute("autoplay")),i.setAttributeNode(document.createAttribute("playsinline")),i.setAttributeNode(document.createAttribute("controls"))}catch(e){i.setAttribute("autoplay",!0),i.setAttribute("playsinline",!0),i.setAttribute("controls",!0)}"Firefox"===DetectRTC.browser.name&&(o="ended","oninactive"in i&&(o="inactive"),i.addEventListener(o,function(){var t,e;currentUserMediaRequest.remove(n.idInstance),"local"===n.type&&(o="ended","oninactive"in n&&(o="inactive"),x.onSyncNeeded(n.streamid,o),r.attachStreams.forEach(function(e,t){n.streamid===e.streamid&&delete r.attachStreams[t]}),t=[],r.attachStreams.forEach(function(e){e&&t.push(e)}),r.attachStreams=t,(e=r.streamEvents[n.streamid])?r.onstreamended(e):this.parentNode&&this.parentNode.removeChild(this))},!1));var s,e=i.play();void 0!==e?(s=!1,setTimeout(function(){s||(s=!0,t(i))},1e3),e.then(function(){s||(s=!0,t(i))}).catch(function(e){s||(s=!0,t(i))})):t(i)}else t({})}function W(e,t){window.removeEventListener(e,t),window.addEventListener(e,t,!1)}function z(e){var t=[];return e.forEach(function(e){e&&t.push(e)}),t}function c(e){return!e.audio&&!e.video&&!e.screen&&e.data}function Y(e){return void 0===e}B=function(){"use strict";function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function D(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function d(e,t,n){return d=D()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&i(o,n.prototype),o},d.apply(null,arguments)}function n(e){var r="function"==typeof Map?new Map:void 0;return n=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,n)}function n(){return d(e,arguments,s(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),i(n,e)},n(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function p(r){var o=D();return function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return j(this,e)}}function B(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=B(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function F(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}var h=Object.create(null),m=(h.open="0",h.close="1",h.ping="2",h.pong="3",h.message="4",h.upgrade="5",h.noop="6",Object.create(null));Object.keys(h).forEach(function(e){m[h[e]]=e});for(var q={type:"error",data:"parser error"},V="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),W="function"==typeof ArrayBuffer,z=function(e,t,n){var r,o=e.type,i=e.data;return V&&i instanceof Blob?t?n(i):Y(i,n):W&&(i instanceof ArrayBuffer||(r=i,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer))?t?n(i):Y(new Blob([i]),n):n(h[o]+(i||""))},Y=function(e,t){var n=new FileReader;return n.onload=function(){var e=n.result.split(",")[1];t("b"+e)},n.readAsDataURL(e)},G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v="undefined"==typeof Uint8Array?[]:new Uint8Array(256),e=0;e<G.length;e++)v[G.charCodeAt(e)]=e;var H="function"==typeof ArrayBuffer,J=function(e,t){if("string"!=typeof e)return{type:"message",data:K(e,t)};var n=e.charAt(0);return"b"===n?{type:"message",data:X(e.substring(1),t)}:m[n]?e.length>1?{type:m[n],data:e.substring(1)}:{type:m[n]}:q},X=function(e,t){if(H){var n=function(e){var t,n,r,o,i,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var u=new ArrayBuffer(s),d=new Uint8Array(u);for(t=0;t<a;t+=4)n=v[e.charCodeAt(t)],r=v[e.charCodeAt(t+1)],o=v[e.charCodeAt(t+2)],i=v[e.charCodeAt(t+3)],d[c++]=n<<2|r>>4,d[c++]=(15&r)<<4|o>>2,d[c++]=(3&o)<<6|63&i;return u}(e);return K(n,t)}return{base64:!0,data:e}},K=function(e,t){return"blob"===t&&e instanceof ArrayBuffer?new Blob([e]):e},$=String.fromCharCode(30);function y(e){if(e)return function(e){for(var t in y.prototype)e[t]=y.prototype[t];return e}(e)}y.prototype.on=y.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},y.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},y.prototype.off=y.prototype.removeListener=y.prototype.removeAllListeners=y.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},y.prototype.emitReserved=y.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},y.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},y.prototype.hasListeners=function(e){return!!this.listeners(e).length};var g="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function Q(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return t.reduce(function(e,t){return n.hasOwnProperty(t)&&(e[t]=n[t]),e},{})}var Z=setTimeout,ee=clearTimeout;function b(e,t){t.useNativeTimers?(e.setTimeoutFn=Z.bind(g),e.clearTimeoutFn=ee.bind(g)):(e.setTimeoutFn=setTimeout.bind(g),e.clearTimeoutFn=clearTimeout.bind(g))}var te,ne=function(e){t(i,e);var o=p(i);function i(e,t,n){var r;return a(this,i),(r=o.call(this,e)).description=t,r.context=n,r.type="TransportError",r}return u(i)}(n(Error)),re=function(e){t(r,e);var n=p(r);function r(e){var t;return a(this,r),(t=n.call(this)).writable=!1,b(f(t),e),t.opts=e,t.query=e.query,t.readyState="",t.socket=e.socket,t}return u(r,[{key:"onError",value:function(e,t,n){return l(s(r.prototype),"emitReserved",this).call(this,"error",new ne(e,t,n)),this}},{key:"open",value:function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(e){"open"===this.readyState&&this.write(e)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,l(s(r.prototype),"emitReserved",this).call(this,"open")}},{key:"onData",value:function(e){var t=J(e,this.socket.binaryType);this.onPacket(t)}},{key:"onPacket",value:function(e){l(s(r.prototype),"emitReserved",this).call(this,"packet",e)}},{key:"onClose",value:function(e){this.readyState="closed",l(s(r.prototype),"emitReserved",this).call(this,"close",e)}}]),r}(y),oe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),ie={},se=0,w=0;function ae(e){var t="";do{t=oe[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function ce(){var e=ae(+new Date);return e!==te?(se=0,te=e):e+"."+ae(se++)}for(;w<64;w++)ie[oe[w]]=w;function ue(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function de(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}var le=!1;try{le="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(c){}var fe=le;function pe(e){var t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||fe))return new XMLHttpRequest}catch(e){}if(!t)try{return new g[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}}function he(){}var me=null!=new pe({xdomain:!1}).responseType,ve=function(e){t(s,e);var i=p(s);function s(e){var t;if(a(this,s),(t=i.call(this,e)).polling=!1,"undefined"!=typeof location){var n="https:"===location.protocol,r=location.port;r||(r=n?"443":"80"),t.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port,t.xs=e.secure!==n}var o=e&&e.forceBase64;return t.supportsBinary=me&&!o,t}return u(s,[{key:"name",get:function(){return"polling"}},{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(e){var t=this;this.readyState="pausing";var n=function(){t.readyState="paused",e()};if(this.polling||!this.writable){var r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}},{key:"poll",value:function(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}},{key:"onData",value:function(e){var t=this;(function(e,t){for(var n=e.split($),r=[],o=0;o<n.length;o++){var i=J(n[o],t);if(r.push(i),"error"===i.type)break}return r})(e,this.socket.binaryType).forEach(function(e){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose({description:"transport closed by the server"}),!1;t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}},{key:"doClose",value:function(){var e=this,t=function(){e.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}},{key:"write",value:function(e){var t=this;this.writable=!1,function(e,n){var r=e.length,o=new Array(r),i=0;e.forEach(function(e,t){z(e,!1,function(e){o[t]=e,++i===r&&n(o.join($))})})}(e,function(e){t.doWrite(e,function(){t.writable=!0,t.emitReserved("drain")})})}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"https":"http",n="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=ce()),this.supportsBinary||e.sid||(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);var r=ue(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}},{key:"request",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(e,{xd:this.xd,xs:this.xs},this.opts),new k(this.uri(),e)}},{key:"doWrite",value:function(e,t){var n=this,r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",function(e,t){n.onError("xhr post error",e,t)})}},{key:"doPoll",value:function(){var n=this,e=this.request();e.on("data",this.onData.bind(this)),e.on("error",function(e,t){n.onError("xhr poll error",e,t)}),this.pollXhr=e}}]),s}(re),k=function(e){t(o,e);var r=p(o);function o(e,t){var n;return a(this,o),b(f(n=r.call(this)),t),n.opts=t,n.method=t.method||"GET",n.uri=e,n.async=!1!==t.async,n.data=void 0!==t.data?t.data:null,n.create(),n}return u(o,[{key:"create",value:function(){var e=this,t=Q(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;var n=this.xhr=new pe(t);try{n.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(var r in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(r)&&n.setRequestHeader(r,this.opts.extraHeaders[r])}catch(e){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=function(){4===n.readyState&&(200===n.status||1223===n.status?e.onLoad():e.setTimeoutFn(function(){e.onError("number"==typeof n.status?n.status:0)},0))},n.send(this.data)}catch(t){return void this.setTimeoutFn(function(){e.onError(t)},0)}"undefined"!=typeof document&&(this.index=o.requestsCount++,o.requests[this.index]=this)}},{key:"onError",value:function(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}},{key:"cleanup",value:function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=he,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete o.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}},{key:"abort",value:function(){this.cleanup()}}]),o}(y);if(k.requestsCount=0,k.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",ye);else if("function"==typeof addEventListener)addEventListener("onpagehide"in g?"pagehide":"unload",ye,!1);function ye(){for(var e in k.requests)k.requests.hasOwnProperty(e)&&k.requests[e].abort()}var ge="function"==typeof Promise&&"function"==typeof Promise.resolve?function(e){return Promise.resolve().then(e)}:function(e,t){return t(e,0)},S=g.WebSocket||g.MozWebSocket,be="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),we,ke={websocket:function(e){t(r,e);var n=p(r);function r(e){var t;return a(this,r),(t=n.call(this,e)).supportsBinary=!e.forceBase64,t}return u(r,[{key:"name",get:function(){return"websocket"}},{key:"doOpen",value:function(){if(this.check()){var e=this.uri(),t=this.opts.protocols,n=be?{}:Q(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=be?new S(e,t,n):t?new S(e,t):new S(e)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}}},{key:"addEventListeners",value:function(){var t=this;this.ws.onopen=function(){t.opts.autoUnref&&t.ws._socket.unref(),t.onOpen()},this.ws.onclose=function(e){return t.onClose({description:"websocket connection closed",context:e})},this.ws.onmessage=function(e){return t.onData(e.data)},this.ws.onerror=function(e){return t.onError("websocket error",e)}}},{key:"write",value:function(r){var o=this;this.writable=!1;for(var e=function(e){var t=r[e],n=e===r.length-1;z(t,o.supportsBinary,function(e){try{o.ws.send(e)}catch(e){}n&&ge(function(){o.writable=!0,o.emitReserved("drain")},o.setTimeoutFn)})},t=0;t<r.length;t++)e(t)}},{key:"doClose",value:function(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"wss":"ws",n="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=ce()),this.supportsBinary||(e.b64=1);var r=ue(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}},{key:"check",value:function(){return!!S}}]),r}(re),polling:ve},Se=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Ee=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function E(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var o,i,s=Se.exec(e||""),a={},c=14;c--;)a[Ee[c]]=s[c]||"";return-1!=n&&-1!=r&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=function(e,t){var n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.substr(0,1)&&0!==t.length||r.splice(0,1);"/"==t.substr(t.length-1,1)&&r.splice(r.length-1,1);return r}(0,a.path),a.queryKey=(o=a.query,i={},o.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,n){t&&(i[t]=n)}),i),a}var C=function(e){t(l,e);var r=p(l);function l(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(this,l),t=r.call(this),e&&"object"===c(e)&&(n=e,e=null),e?(e=E(e),n.hostname=e.host,n.secure="https"===e.protocol||"wss"===e.protocol,n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=E(n.host).host),b(f(t),n),t.secure=null!=n.secure?n.secure:"undefined"!=typeof location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=t.secure?"443":"80"),t.hostname=n.hostname||("undefined"!=typeof location?location.hostname:"localhost"),t.port=n.port||("undefined"!=typeof location&&location.port?location.port:t.secure?"443":"80"),t.transports=n.transports||["polling","websocket"],t.readyState="",t.writeBuffer=[],t.prevBufferLen=0,t.opts=o({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},n),t.opts.path=t.opts.path.replace(/\/$/,"")+"/","string"==typeof t.opts.query&&(t.opts.query=de(t.opts.query)),t.id=null,t.upgrades=null,t.pingInterval=null,t.pingTimeout=null,t.pingTimeoutTimer=null,"function"==typeof addEventListener&&(t.opts.closeOnBeforeunload&&addEventListener("beforeunload",function(){t.transport&&(t.transport.removeAllListeners(),t.transport.close())},!1),"localhost"!==t.hostname&&(t.offlineEventListener=function(){t.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",t.offlineEventListener,!1))),t.open(),t}return u(l,[{key:"createTransport",value:function(e){var t=o({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);var n=o({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new ke[e](n)}},{key:"open",value:function(){var e,t=this;if(this.opts.rememberUpgrade&&l.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(function(){t.emitReserved("error","No transports available")},0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}},{key:"setTransport",value:function(e){var t=this;this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",function(e){return t.onClose("transport close",e)})}},{key:"probe",value:function(e){var n=this,r=this.createTransport(e),o=!1;l.priorWebsocketSuccess=!1;var t=function(){o||(r.send([{type:"ping",data:"probe"}]),r.once("packet",function(e){if(!o)if("pong"===e.type&&"probe"===e.data){if(n.upgrading=!0,n.emitReserved("upgrading",r),!r)return;l.priorWebsocketSuccess="websocket"===r.name,n.transport.pause(function(){o||"closed"!==n.readyState&&(d(),n.setTransport(r),r.send([{type:"upgrade"}]),n.emitReserved("upgrade",r),r=null,n.upgrading=!1,n.flush())})}else{var t=new Error("probe error");t.transport=r.name,n.emitReserved("upgradeError",t)}}))};function i(){o||(o=!0,d(),r.close(),r=null)}var s=function(e){var t=new Error("probe error: "+e);t.transport=r.name,i(),n.emitReserved("upgradeError",t)};function a(){s("transport closed")}function c(){s("socket closed")}function u(e){r&&e.name!==r.name&&i()}var d=function(){r.removeListener("open",t),r.removeListener("error",s),r.removeListener("close",a),n.off("close",c),n.off("upgrading",u)};r.once("open",t),r.once("error",s),r.once("close",a),this.once("close",c),this.once("upgrading",u),r.open()}},{key:"onOpen",value:function(){if(this.readyState="open",l.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause)for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},{key:"onPacket",value:function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}},{key:"onHandshake",value:function(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var e=this;this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(function(){e.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}},{key:"flush",value:function(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){var e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}},{key:"getWritablePackets",value:function(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;for(var e,t=1,n=0;n<this.writeBuffer.length;n++){var r=this.writeBuffer[n].data;if(r&&(t+="string"==typeof(e=r)?function(e){for(var t=0,n=0,r=0,o=e.length;r<o;r++)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))),n>0&&t>this.maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}},{key:"write",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"send",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"sendPacket",value:function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}}},{key:"close",value:function(){var t=this,n=function(){t.onClose("forced close"),t.transport.close()},e=function e(){t.off("upgrade",e),t.off("upgradeError",e),n()},r=function(){t.once("upgrade",e),t.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",function(){t.upgrading?r():n()}):this.upgrading?r():n()),this}},{key:"onError",value:function(e){l.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}},{key:"onClose",value:function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}},{key:"filterUpgrades",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}]),l}(y),Ce=(C.protocol=4,C.protocol,"function"==typeof ArrayBuffer),Re=Object.prototype.toString,Te="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Re.call(Blob),Ae="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Re.call(File),R;function T(e){return Ce&&(e instanceof ArrayBuffer||function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}(e))||Te&&e instanceof Blob||Ae&&e instanceof File}function A(e,t){if(!e||"object"!==c(e))return!1;if(Array.isArray(e)){for(var n=0,r=e.length;n<r;n++)if(A(e[n]))return!0;return!1}if(T(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return A(e.toJSON(),!0);for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&A(e[o]))return!0;return!1}function xe(e){var t=[],n=e.data,r=e;return r.data=x(n,t),r.attachments=t.length,{packet:r,buffers:t}}function x(e,t){if(!e)return e;if(T(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){for(var r=new Array(e.length),o=0;o<e.length;o++)r[o]=x(e[o],t);return r}if("object"===c(e)&&!(e instanceof Date)){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(i[s]=x(e[s],t));return i}return e}function Oe(e,t){return e.data=O(e.data,t),e.attachments=void 0,e}function O(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]=O(e[n],t);else if("object"===c(e))for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=O(e[r],t));return e}var P=R||(R={}),Pe=(P[P.CONNECT=0]="CONNECT",P[P.DISCONNECT=1]="DISCONNECT",P[P.EVENT=2]="EVENT",P[P.ACK=3]="ACK",P[P.CONNECT_ERROR=4]="CONNECT_ERROR",P[P.BINARY_EVENT=5]="BINARY_EVENT",P[P.BINARY_ACK=6]="BINARY_ACK",function(){function t(e){a(this,t),this.replacer=e}return u(t,[{key:"encode",value:function(e){return e.type!==R.EVENT&&e.type!==R.ACK||!A(e)?[this.encodeAsString(e)]:(e.type=e.type===R.EVENT?R.BINARY_EVENT:R.BINARY_ACK,this.encodeAsBinary(e))}},{key:"encodeAsString",value:function(e){var t=""+e.type;return e.type!==R.BINARY_EVENT&&e.type!==R.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}},{key:"encodeAsBinary",value:function(e){var t=xe(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}]),t}()),_e=function(e){t(d,e);var n=p(d);function d(e){var t;return a(this,d),(t=n.call(this)).reviver=e,t}return u(d,[{key:"add",value:function(e){var t;if("string"==typeof e)(t=this.decodeString(e)).type===R.BINARY_EVENT||t.type===R.BINARY_ACK?(this.reconstructor=new Ne(t),0===t.attachments&&l(s(d.prototype),"emitReserved",this).call(this,"decoded",t)):l(s(d.prototype),"emitReserved",this).call(this,"decoded",t);else{if(!T(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,l(s(d.prototype),"emitReserved",this).call(this,"decoded",t))}}},{key:"decodeString",value:function(e){var t=0,n={type:Number(e.charAt(0))};if(void 0===R[n.type])throw new Error("unknown packet type "+n.type);if(n.type===R.BINARY_EVENT||n.type===R.BINARY_ACK){for(var r=t+1;"-"!==e.charAt(++t)&&t!=e.length;);var o=e.substring(r,t);if(o!=Number(o)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(o)}if("/"===e.charAt(t+1)){for(var i=t+1;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(i,t)}else n.nsp="/";var s=e.charAt(t+1);if(""!==s&&Number(s)==s){for(var a=t+1;++t;){var c=e.charAt(t);if(null==c||Number(c)!=c){--t;break}if(t===e.length)break}n.id=Number(e.substring(a,t+1))}if(e.charAt(++t)){var u=this.tryParse(e.substr(t));if(!d.isPayloadValid(n.type,u))throw new Error("invalid payload");n.data=u}return n}},{key:"tryParse",value:function(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}},{key:"destroy",value:function(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}],[{key:"isPayloadValid",value:function(e,t){switch(e){case R.CONNECT:return"object"===c(t);case R.DISCONNECT:return void 0===t;case R.CONNECT_ERROR:return"string"==typeof t||"object"===c(t);case R.EVENT:case R.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case R.ACK:case R.BINARY_ACK:return Array.isArray(t)}}}]),d}(y),Ne=function(){function t(e){a(this,t),this.packet=e,this.buffers=[],this.reconPack=e}return u(t,[{key:"takeBinaryData",value:function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=Oe(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),t}(),Ie=Object.freeze({__proto__:null,protocol:5,get PacketType(){return R},Encoder:Pe,Decoder:_e});function _(e,t,n){return e.on(t,n),function(){e.off(t,n)}}var Le=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Me=function(e){t(i,e);var o=p(i);function i(e,t,n){var r;return a(this,i),(r=o.call(this)).connected=!1,r.receiveBuffer=[],r.sendBuffer=[],r.ids=0,r.acks={},r.flags={},r.io=e,r.nsp=t,n&&n.auth&&(r.auth=n.auth),r.io._autoConnect&&r.open(),r}return u(i,[{key:"disconnected",get:function(){return!this.connected}},{key:"subEvents",value:function(){if(!this.subs){var e=this.io;this.subs=[_(e,"open",this.onopen.bind(this)),_(e,"packet",this.onpacket.bind(this)),_(e,"error",this.onerror.bind(this)),_(e,"close",this.onclose.bind(this))]}}},{key:"active",get:function(){return!!this.subs}},{key:"connect",value:function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift("message"),this.emit.apply(this,t),this}},{key:"emit",value:function(e){if(Le.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.unshift(e);var o={type:R.EVENT,data:n,options:{}};if(o.options.compress=!1!==this.flags.compress,"function"==typeof n[n.length-1]){var i=this.ids++,s=n.pop();this._registerAckCallback(i,s),o.id=i}var a=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,c=this.flags.volatile&&(!a||!this.connected);return c||(this.connected?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}},{key:"_registerAckCallback",value:function(t,r){var o=this,e=this.flags.timeout;if(void 0!==e){var i=this.io.setTimeoutFn(function(){delete o.acks[t];for(var e=0;e<o.sendBuffer.length;e++)o.sendBuffer[e].id===t&&o.sendBuffer.splice(e,1);r.call(o,new Error("operation has timed out"))},e);this.acks[t]=function(){o.io.clearTimeoutFn(i);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.apply(o,[null].concat(t))}}else this.acks[t]=r}},{key:"packet",value:function(e){e.nsp=this.nsp,this.io._packet(e)}},{key:"onopen",value:function(){var t=this;"function"==typeof this.auth?this.auth(function(e){t.packet({type:R.CONNECT,data:e})}):this.packet({type:R.CONNECT,data:this.auth})}},{key:"onerror",value:function(e){this.connected||this.emitReserved("connect_error",e)}},{key:"onclose",value:function(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}},{key:"onpacket",value:function(e){if(e.nsp===this.nsp)switch(e.type){case R.CONNECT:if(e.data&&e.data.sid){var t=e.data.sid;this.onconnect(t)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case R.EVENT:case R.BINARY_EVENT:this.onevent(e);break;case R.ACK:case R.BINARY_ACK:this.onack(e);break;case R.DISCONNECT:this.ondisconnect();break;case R.CONNECT_ERROR:this.destroy();var n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n)}}},{key:"onevent",value:function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}},{key:"emitEvent",value:function(e){if(this._anyListeners&&this._anyListeners.length){var t,n=F(this._anyListeners.slice());try{for(n.s();!(t=n.n()).done;)t.value.apply(this,e)}catch(e){n.e(e)}finally{n.f()}}l(s(i.prototype),"emit",this).apply(this,e)}},{key:"ack",value:function(r){var o=this,i=!1;return function(){if(!i){i=!0;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];o.packet({type:R.ACK,id:r,data:t})}}}},{key:"onack",value:function(e){var t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}},{key:"onconnect",value:function(e){this.id=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}},{key:"emitBuffered",value:function(){var t=this;this.receiveBuffer.forEach(function(e){return t.emitEvent(e)}),this.receiveBuffer=[],this.sendBuffer.forEach(function(e){t.notifyOutgoingListeners(e),t.packet(e)}),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){this.subs&&(this.subs.forEach(function(e){return e()}),this.subs=void 0),this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&this.packet({type:R.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(e){return this.flags.compress=e,this}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}},{key:"timeout",value:function(e){return this.flags.timeout=e,this}},{key:"onAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}},{key:"prependAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}},{key:"offAny",value:function(e){if(!this._anyListeners)return this;if(e){for(var t=this._anyListeners,n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}},{key:"onAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}},{key:"prependAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}},{key:"offAnyOutgoing",value:function(e){if(!this._anyOutgoingListeners)return this;if(e){for(var t=this._anyOutgoingListeners,n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}},{key:"listenersAnyOutgoing",value:function(){return this._anyOutgoingListeners||[]}},{key:"notifyOutgoingListeners",value:function(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){var t,n=F(this._anyOutgoingListeners.slice());try{for(n.s();!(t=n.n()).done;)t.value.apply(this,e.data)}catch(e){n.e(e)}finally{n.f()}}}}]),i}(y);function N(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}N.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},N.prototype.reset=function(){this.attempts=0},N.prototype.setMin=function(e){this.ms=e},N.prototype.setMax=function(e){this.max=e},N.prototype.setJitter=function(e){this.jitter=e};var I=function(e){t(s,e);var i=p(s);function s(e,t){var n,r;a(this,s),(n=i.call(this)).nsps={},n.subs=[],e&&"object"===c(e)&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",n.opts=t,b(f(n),t),n.reconnection(!1!==t.reconnection),n.reconnectionAttempts(t.reconnectionAttempts||1/0),n.reconnectionDelay(t.reconnectionDelay||1e3),n.reconnectionDelayMax(t.reconnectionDelayMax||5e3),n.randomizationFactor(null!==(r=t.randomizationFactor)&&void 0!==r?r:.5),n.backoff=new N({min:n.reconnectionDelay(),max:n.reconnectionDelayMax(),jitter:n.randomizationFactor()}),n.timeout(null==t.timeout?2e4:t.timeout),n._readyState="closed",n.uri=e;var o=t.parser||Ie;return n.encoder=new o.Encoder,n.decoder=new o.Decoder,n._autoConnect=!1!==t.autoConnect,n._autoConnect&&n.open(),n}return u(s,[{key:"reconnection",value:function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}},{key:"reconnectionAttempts",value:function(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}},{key:"reconnectionDelay",value:function(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}},{key:"randomizationFactor",value:function(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}},{key:"reconnectionDelayMax",value:function(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}},{key:"timeout",value:function(e){return arguments.length?(this._timeout=e,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(t){var n=this;if(~this._readyState.indexOf("open"))return this;this.engine=new C(this.uri,this.opts);var e=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;var o=_(e,"open",function(){r.onopen(),t&&t()}),i=_(e,"error",function(e){r.cleanup(),r._readyState="closed",n.emitReserved("error",e),t?t(e):r.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;0===s&&o();var a=this.setTimeoutFn(function(){o(),e.close(),e.emit("error",new Error("timeout"))},s);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(o),this.subs.push(i),this}},{key:"connect",value:function(e){return this.open(e)}},{key:"onopen",value:function(){this.cleanup(),this._readyState="open",this.emitReserved("open");var e=this.engine;this.subs.push(_(e,"ping",this.onping.bind(this)),_(e,"data",this.ondata.bind(this)),_(e,"error",this.onerror.bind(this)),_(e,"close",this.onclose.bind(this)),_(this.decoder,"decoded",this.ondecoded.bind(this)))}},{key:"onping",value:function(){this.emitReserved("ping")}},{key:"ondata",value:function(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error")}}},{key:"ondecoded",value:function(e){this.emitReserved("packet",e)}},{key:"onerror",value:function(e){this.emitReserved("error",e)}},{key:"socket",value:function(e,t){var n=this.nsps[e];return n||(n=new Me(this,e,t),this.nsps[e]=n),n}},{key:"_destroy",value:function(e){for(var t=0,n=Object.keys(this.nsps);t<n.length;t++){var r=n[t];if(this.nsps[r].active)return}this._close()}},{key:"_packet",value:function(e){for(var t=this.encoder.encode(e),n=0;n<t.length;n++)this.engine.write(t[n],e.options)}},{key:"cleanup",value:function(){this.subs.forEach(function(e){return e()}),this.subs.length=0,this.decoder.destroy()}},{key:"_close",value:function(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var t=this;if(this._reconnecting||this.skipReconnect)return this;var n=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var e=this.backoff.duration();this._reconnecting=!0;var r=this.setTimeoutFn(function(){n.skipReconnect||(t.emitReserved("reconnect_attempt",n.backoff.attempts),n.skipReconnect||n.open(function(e){e?(n._reconnecting=!1,n.reconnect(),t.emitReserved("reconnect_error",e)):n.onreconnect()}))},e);this.opts.autoUnref&&r.unref(),this.subs.push(function(){clearTimeout(r)})}}},{key:"onreconnect",value:function(){var e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}]),s}(y),L={};function M(e,t){"object"===c(e)&&(t=e,e=void 0);var n,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==n?n.protocol+"//"+e:"https://"+e),r=E(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var o=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port+t,r.href=r.protocol+"://"+o+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),o=r.source,i=r.id,s=r.path,a=L[i]&&s in L[i].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||a?n=new I(o,t):(L[i]||(L[i]=new I(o,t)),n=L[i]),r.query&&!t.query&&(t.query=r.queryKey),n.socket(r.path,t)}return o(M,{Manager:I,Socket:Me,io:M,connect:M}),M}(),(t=void 0!==De?De:null)&&"undefined"==typeof window&&void 0!==De&&(De.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},De.console||(De.console={}),void 0===De.console.debug&&(De.console.debug=De.console.info=De.console.error=De.console.log=De.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(t.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""}};return e},document.addEventListener=document.removeEventListener=t.addEventListener=t.removeEventListener=function(){},t.HTMLVideoElement=t.HTMLMediaElement=function(){}),0==typeof location&&(t.location={protocol:"file:",href:"",hash:"",origin:"self"}),"undefined"==typeof screen&&(t.screen={width:0,height:0}),"undefined"==typeof URL&&(t.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),t.window=De);var e,t="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",a=("object"===(void 0===je?"undefined":Be(je))&&"object"===Be(je.versions)&&je.versions.node&&!je.browser&&(e=je.versions.node.toString().replace("v",""),t="Nodejs/"+e+" (NodeOS) AppleWebKit/"+e+" (KHTML, like Gecko) Nodejs/"+e+" Nodejs/"+e),e=void 0!==De?De:window,"undefined"==typeof window&&("undefined"==typeof window&&void 0!==De&&(De.navigator={userAgent:t,getUserMedia:function(){}},e.window=De),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen)&&(e.screen={width:0,height:0}),window.navigator),t=(void 0!==a?(void 0!==a.webkitGetUserMedia&&(a.getUserMedia=a.webkitGetUserMedia),void 0!==a.mozGetUserMedia&&(a.getUserMedia=a.mozGetUserMedia)):a={getUserMedia:function(){},userAgent:t},!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(a.userAgent||"")),G=!(-1===a.userAgent.indexOf("Edge")||!a.msSaveOrOpenBlob&&!a.msSaveBlob),H=!!window.opera||0<=a.userAgent.indexOf(" OPR/"),J=void 0!==window.InstallTrigger,X=/^((?!chrome|android).)*safari/i.test(a.userAgent),K=!!window.chrome&&!H,$="undefined"!=typeof document&&!!document.documentMode&&!G;function Q(e,t){var n=0,r=!1,o=window.setInterval(function(){e()&&(window.clearInterval(o),t(r)),50<n++&&(window.clearInterval(o),t(r=!0))},10)}var r,Z,o={Android:function(){return a.userAgent.match(/Android/i)},BlackBerry:function(){return a.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return a.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return a.userAgent.match(/Opera Mini/i)},Windows:function(){return a.userAgent.match(/IEMobile/i)},any:function(){return o.Android()||o.BlackBerry()||o.iOS()||o.Opera()||o.Windows()},getOsName:function(){var e="Unknown OS";return o.Android()&&(e="Android"),o.BlackBerry()&&(e="BlackBerry"),o.iOS()&&(e="iOS"),o.Opera()&&(e="Opera Mini"),e=o.Windows()?"Windows":e}},i="Unknown OS",s="Unknown OS Version",u=((g=function(){for(var e,t=a.appVersion,n=a.userAgent,r="-",o=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],i=0;e=o[i];i++)if(e.r.test(n)){r=e.s;break}var s="-";switch(/Windows/.test(r)&&(/Windows (.*)/.test(r)&&(s=/Windows (.*)/.exec(r)[1]),r="Windows"),r){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(n)&&(s=/Mac OS X (10[\.\_\d]+)/.exec(n)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(n)&&(s=/Android ([\.\_\d]+)/.exec(n)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(n)&&(s=(s=/OS (\d+)_(\d+)_?(\d+)?/.exec(t))[1]+"."+s[2]+"."+(0|s[3]))}return{osName:r,osVersion:s}}())&&g.osName&&"-"!=g.osName?(i=g.osName,s=g.osVersion):o.any()&&"Android"==(i=o.getOsName())&&(s=!!(g=(u=(u||a.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/))&&g[1]),"object"===(void 0===je?"undefined":Be(je))&&"object"===Be(je.versions)&&je.versions.node),ee=("Unknown OS"===i&&u&&(i="Nodejs",s=je.versions.node.toString().replace("v","")),!1),te=!1,ne=(["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!ee&&e in document.createElement("canvas")&&(ee=!0),!te)&&e in document.createElement("video")&&(te=!0)}),/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/),re=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,oe=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/,d=[],l=[],p=[],h=[],ie=(a.mediaDevices&&a.mediaDevices.enumerateDevices&&(a.enumerateDevices=function(e){var t=a.mediaDevices.enumerateDevices();t&&t.then?a.mediaDevices.enumerateDevices().then(e).catch(function(){e([])}):e([])}),!1),se=((void 0!==R&&"getSources"in R||a.mediaDevices&&a.mediaDevices.enumerateDevices)&&(ie=!0),!1),ae=!1,ce=!1,m=!1,v=!1,y=window.DetectRTC||{};y.browser=function(){a.appVersion;var e,t,n=a.userAgent,r=a.appName,o=""+parseFloat(a.appVersion),i=parseInt(a.appVersion,10);if(X&&!K&&-1!==n.indexOf("CriOS")&&(K=!(X=!1)),H){r="Opera";try{i=(o=a.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){o="0.0.0.0",i=0}}else $?(o=0<(e=n.indexOf("rv:"))?n.substring(e+3):(e=n.indexOf("MSIE"),n.substring(e+5)),r="IE"):K?(e=n.indexOf("Chrome"),r="Chrome",o=n.substring(e+7)):X?(e=n.indexOf("Safari"),r="Safari",o=n.substring(e+7),-1!==(e=n.indexOf("Version"))&&(o=n.substring(e+8)),-1!==a.userAgent.indexOf("Version/")&&(o=a.userAgent.split("Version/")[1].split(" ")[0])):J?(e=n.indexOf("Firefox"),r="Firefox",o=n.substring(e+8)):(t=n.lastIndexOf(" ")+1)<(e=n.lastIndexOf("/"))&&(r=n.substring(t,e),o=n.substring(e+1),r.toLowerCase()===r.toUpperCase())&&(r=a.appName);return G&&(r="Edge",o=a.userAgent.split("Edge/")[1]),-1!==(t=o.search(/[; \)]/))&&(o=o.substring(0,t)),i=parseInt(""+o,10),isNaN(i)&&(o=""+parseFloat(a.appVersion),i=parseInt(a.appVersion,10)),{fullVersion:o,version:i,name:r,isPrivateBrowsing:!1}}();try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){r=!1},function(e){r=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){try{(Z=window.indexedDB.open("test")).onerror=function(){return!0}}catch(e){r=!0}void 0===r&&Q(function(){return"done"===Z.readyState},function(e){e||(r=!Z.result)})}else if(function(){var e=window.navigator.userAgent.toLowerCase();if(0!==e.indexOf("msie")||0!==e.indexOf("trident"))return(e=/(?:msie|rv:)\s?([\d\.]+)/.exec(e))&&10<=parseInt(e[1],10)}()){r=!1;try{window.indexedDB||(r=!0)}catch(e){r=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){r=!0}void 0===r&&(r=!1,window.localStorage.removeItem("test"))}}catch(e){r=!1}Q(function(){return void 0!==r},function(e){var t;t=r,y.browser.isPrivateBrowsing=!!t}),y.browser["is"+y.browser.name]=!0,y.osName=i,y.osVersion=s,"object"===(void 0===je?"undefined":Be(je))&&"object"===Be(je.versions)&&je.versions["node-webkit"];var ue=!1,g=(["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(e){ue||e in window&&(ue=!0)}),y.isWebRTCSupported=ue,y.isORTCSupported="undefined"!=typeof RTCIceGatherer,!1),b=((y.browser.isChrome&&35<=y.browser.version||y.browser.isFirefox&&34<=y.browser.version||y.browser.isEdge&&17<=y.browser.version||"Android"===y.osName&&y.browser.isChrome)&&(g=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||"")||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(y.browser.isChrome||y.browser.isEdge||y.browser.isOpera)||y.browser.isFirefox)&&(g=!1),y.isScreenCapturingSupported=g,{isSupported:!1,isCreateMediaStreamSourceSupported:!1}),u=(["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(e){b.isSupported||e in window&&(b.isSupported=!0,window[e])&&"createMediaStreamSource"in window[e].prototype&&(b.isCreateMediaStreamSourceSupported=!0)}),y.isAudioContextSupported=b.isSupported,y.isCreateMediaStreamSourceSupported=b.isCreateMediaStreamSourceSupported,!1),i=(y.browser.isChrome&&31<y.browser.version&&(u=!0),y.isRtpDataChannelsSupported=u,!1),s=((y.browser.isFirefox&&28<y.browser.version||y.browser.isChrome&&25<y.browser.version||y.browser.isOpera&&11<=y.browser.version)&&(i=!0),y.isSctpDataChannelsSupported=i,y.isMobileDevice=t,!1),w=((a.getUserMedia||a.mediaDevices&&a.mediaDevices.getUserMedia)&&(s=!0),y.browser.isChrome&&46<=y.browser.version&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(s="Requires HTTPs"),"Nodejs"===y.osName&&(s=!1),y.isGetUserMediaSupported=s,g="",screen.width&&(g+=(screen.width||"")+" x "+(screen.height||"")),y.displayResolution=g,y.displayAspectRatio=((u=screen.width)/(t=function e(t,n){return 0==n?t:e(n,t%n)}(u,i=screen.height))/(i/t)).toFixed(2),y.isCanvasSupportsStreamCapturing=ee,y.isVideoSupportsStreamCapturing=te,"Chrome"==y.browser.name&&53<=y.browser.version&&(y.isCanvasSupportsStreamCapturing||(y.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),y.isVideoSupportsStreamCapturing||(y.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),y.DetectLocalIPAddress=function(n,e){if(y.isWebRTCSupported){var r=!0,o=!0;if("undefined"!=typeof document&&"function"==typeof document.getElementById){var i={};if(!(s=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection)){var t=document.getElementById("iframe");if(!t)return;var t=t.contentWindow,s=t.RTCPeerConnection||t.mozRTCPeerConnection||t.webkitRTCPeerConnection}if(s){var t=null,a=new s({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},t="Chrome"===y.browser&&y.browser.version<58?{optional:[{RtpDataChannels:!0}]}:t);if(e&&(a.addStream?a.addStream(e):a.addTrack&&e.getTracks()[0]&&a.addTrack(e.getTracks()[0],e)),a.onicecandidate=function(e){e.candidate&&c(e.candidate.candidate)},!e)try{a.createDataChannel("sctp",{})}catch(e){}y.isPromisesSupported?a.createOffer().then(function(e){a.setLocalDescription(e).then(u)}):a.createOffer(function(e){a.setLocalDescription(e,u,function(){})},function(){})}}function c(e){var t=re.exec(e);t&&(t=t[1],e.match(ne),void 0===i[t]&&((e=t).match(ne)?n("Local: "+e,r=!1,o):e.match(oe)?n("Public: "+e,r,o=!1):n("Public: "+e,r,o)),i[t]=!0)}function u(){a.localDescription.sdp.split("\n").forEach(function(e){0===e.indexOf("a=candidate:")&&c(e)})}}},y.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,y.isWebSocketsBlocked=!y.isWebSocketsSupported,"Nodejs"===y.osName&&(y.isWebSocketsSupported=!0,y.isWebSocketsBlocked=!1),y.checkWebSocketsSupport=function(t){t=t||function(){};try{var e,n=new WebSocket("wss://echo.websocket.org:443/");n.onopen=function(){y.isWebSocketsBlocked=!1,e=(new Date).getTime(),n.send("ping")},n.onmessage=function(){y.WebsocketLatency=(new Date).getTime()-e+"ms",t(),n.close(),n=null},n.onerror=function(){y.isWebSocketsBlocked=!0,t()}}catch(e){y.isWebSocketsBlocked=!0,t()}},y.load=function(e){var t,r;t=e=e||function(){},ie&&(!a.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(a.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!a.enumerateDevices&&a.enumerateDevices&&(a.enumerateDevices=a.enumerateDevices.bind(a)),a.enumerateDevices)?(d=[],l=[],p=[],v=m=ce=ae=se=!(h=[]),r={},a.enumerateDevices(function(e){e.forEach(function(e){var t,n={};for(t in e)try{"function"!=typeof e[t]&&(n[t]=e[t])}catch(e){}r[n.deviceId+n.label+n.kind]||("audio"===n.kind&&(n.kind="audioinput"),"video"===n.kind&&(n.kind="videoinput"),n.deviceId||(n.deviceId=n.id),n.id||(n.id=n.deviceId),n.label?("videoinput"===n.kind&&(v=v||!0),"audioinput"===n.kind&&(m=m||!0)):(n.isCustomLabel=!0,n.label="videoinput"===n.kind?"Camera "+(h.length+1):"audioinput"===n.kind?"Microphone "+(l.length+1):"audiooutput"===n.kind?"Speaker "+(p.length+1):"Please invoke getUserMedia once.",void 0!==y&&y.browser.isChrome&&46<=y.browser.version&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(n.label="HTTPs is required to get label of this "+n.kind+" device.")),"audioinput"===n.kind&&(se=!0,-1===l.indexOf(n))&&l.push(n),"audiooutput"===n.kind&&(ae=!0,-1===p.indexOf(n))&&p.push(n),"videoinput"===n.kind&&(ce=!0,-1===h.indexOf(n))&&h.push(n),d.push(n),r[n.deviceId+n.label+n.kind]=n)}),void 0!==y&&(y.MediaDevices=d,y.hasMicrophone=se,y.hasSpeakers=ae,y.hasWebcam=ce,y.isWebsiteHasWebcamPermissions=v,y.isWebsiteHasMicrophonePermissions=m,y.audioInputDevices=l,y.audioOutputDevices=p,y.videoInputDevices=h),t&&t()})):t&&t()},y.MediaDevices=void 0!==d?d:[],y.hasMicrophone=se,y.hasSpeakers=ae,y.hasWebcam=ce,y.isWebsiteHasWebcamPermissions=v,y.isWebsiteHasMicrophonePermissions=m,y.audioInputDevices=l,y.audioOutputDevices=p,y.videoInputDevices=h,s=!1,"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&(s=!0),y.isSetSinkIdSupported=s,g=!1,y.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(g=!0):y.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(g=!0),y.isRTPSenderReplaceTracksSupported=g,u=!1,y.browser.isFirefox&&38<y.browser.version&&(u=!0),y.isRemoteStreamProcessingSupported=u,i=!1,void 0!==R&&"applyConstraints"in R.prototype&&(i=!0),y.isApplyConstraintsSupported=i,t=!1,y.browser.isFirefox&&43<=y.browser.version&&(t=!0),y.isMultiMonitorScreenCapturingSupported=t,y.isPromisesSupported=!!("Promise"in window),y.version="1.3.7",void 0===y&&(window.DetectRTC={}),void 0===(s=window.MediaStream)&&"undefined"!=typeof webkitMediaStream&&(s=webkitMediaStream),y.MediaStream=void 0!==s&&"function"==typeof s&&Object.keys(s.prototype),y.MediaStreamTrack=void 0!==R&&Object.keys(R.prototype),g=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,y.RTCPeerConnection=void 0!==g&&Object.keys(g.prototype),window.DetectRTC=y,"function"==typeof define&&Ve(144)&&define("DetectRTC",[],function(){return y}),"undefined"!=typeof cordova&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Crosswalk")&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),window.addEventListener||(window.addEventListener=function(e,t,n){e.attachEvent&&e.attachEvent("on"+t,n)}),window.attachEventListener=function(e,t,n,r){e.addEventListener(t,n,r)},window.MediaStream);function k(e,t){return!(e.session.audio&&"two-way"===e.session.audio||("Firefox"!==DetectRTC.browser.name||!1===t)&&("Chrome"!==DetectRTC.browser.name||DetectRTC.browser.version<50||!0!==typeof t&&(void 0!==t||!e.session.audio||!e.session.screen||e.session.video)))}function de(e){return"Firefox"===DetectRTC.browser.name||"Chrome"===DetectRTC.browser.name&&{mandatory:{chromeMediaSource:e.mandatory.chromeMediaSource,chromeMediaSourceId:e.mandatory.chromeMediaSourceId}}}function S(e,t){return e&&e.getTracks?e.getTracks().filter(function(e){return e.kind===(t||"audio")}):[]}function le(){var e;"undefined"!=typeof cordova&&void 0!==cordova.plugins&&void 0!==cordova.plugins.iosrtc&&(e=cordova.plugins.iosrtc,window.webkitRTCPeerConnection=e.RTCPeerConnection,window.RTCSessionDescription=e.RTCSessionDescription,window.RTCIceCandidate=e.RTCIceCandidate,window.MediaStream=e.MediaStream,window.MediaStreamTrack=e.MediaStreamTrack,navigator.getUserMedia=navigator.webkitGetUserMedia=e.getUserMedia,e.debug.enable("iosrtc*"),"function"==typeof e.selectAudioOutput&&e.selectAudioOutput(window.iOSDefaultAudioOutputDevice||"speaker"),e.registerGlobals())}void 0===(w=void 0===w&&"undefined"!=typeof webkitMediaStream?webkitMediaStream:w)||"stop"in w.prototype||(w.prototype.stop=function(){this.getTracks().forEach(function(e){e.stop()})}),window.iOSDefaultAudioOutputDevice=window.iOSDefaultAudioOutputDevice||"speaker",document.addEventListener("deviceready",le,!1),le();var E,C={};function fe(e){return{OfferToReceiveAudio:!!e.OfferToReceiveAudio,OfferToReceiveVideo:!!e.OfferToReceiveVideo}}void 0!==window.RTCPeerConnection?E=window.RTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?E=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection&&(E=webkitRTCPeerConnection);var pe=window.RTCSessionDescription||window.mozRTCSessionDescription,he=window.RTCIceCandidate||window.mozRTCIceCandidate,R=window.MediaStreamTrack;function me(n){if(void 0!==window.RTCPeerConnection?E=window.RTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?E=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection&&(E=webkitRTCPeerConnection),pe=window.RTCSessionDescription||window.mozRTCSessionDescription,he=window.RTCIceCandidate||window.mozRTCIceCandidate,R=window.MediaStreamTrack,!E)throw"WebRTC 1.0 (RTCPeerConnection) API are NOT available in this browser.";var r=n.rtcMultiConnection,o=(this.extra=(n.remoteSdp||r).extra,this.userid=n.userid,this.streams=[],this.channels=n.channels||[],this.connectionDescription=n.connectionDescription,this.addStream=function(e){r.addStream(e,o.userid)},this.removeStream=function(e){r.removeStream(e,o.userid)},this);n.remoteSdp&&(this.connectionDescription=n.remoteSdp.connectionDescription);var i,s={},e=(C.sdpConstraints=fe({OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}),!!n.renegotiatingPeer),t=(n.remoteSdp&&(e=!!n.remoteSdp.renegotiatingPeer),[]);if(r.attachStreams.forEach(function(e){e&&t.push(e)}),e)i=n.peerRef;else{var a="all";!r.candidates.turn&&!r.candidates.relay||r.candidates.stun||r.candidates.reflexive||r.candidates.host||(a="relay");try{var c={iceServers:r.iceServers,iceTransportPolicy:r.iceTransportPolicy||a};void 0!==r.iceCandidatePoolSize&&(c.iceCandidatePoolSize=r.iceCandidatePoolSize),void 0!==r.bundlePolicy&&(c.bundlePolicy=r.bundlePolicy),void 0!==r.rtcpMuxPolicy&&(c.rtcpMuxPolicy=r.rtcpMuxPolicy),"Chrome"===DetectRTC.browser.name&&(c.sdpSemantics=r.sdpSemantics||"unified-plan"),r.iceServers&&r.iceServers.length||(c=null,r.optionalArgument=null),i=new E(c,r.optionalArgument)}catch(e){try{c={iceServers:r.iceServers},i=new E(c)}catch(e){i=new E}}}!i.getRemoteStreams&&i.getReceivers&&(i.getRemoteStreams=function(){var t=new w;return i.getReceivers().forEach(function(e){t.addTrack(e.track)}),[t]}),!i.getLocalStreams&&i.getSenders&&(i.getLocalStreams=function(){var t=new w;return i.getSenders().forEach(function(e){t.addTrack(e.track)}),[t]}),i.onicecandidate=function(e){e.candidate?r.trickleIce&&n.onLocalCandidate({candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex}):r.trickleIce||(e=i.localDescription,n.onLocalSdp({type:e.type,sdp:e.sdp,remotePeerSdpConstraints:n.remotePeerSdpConstraints||!1,renegotiatingPeer:!!n.renegotiatingPeer||!1,connectionDescription:o.connectionDescription,dontGetRemoteStream:!!n.dontGetRemoteStream,extra:r?r.extra:{},streamsToShare:l}))},t.forEach(function(t){n.remoteSdp&&n.remoteSdp.remotePeerSdpConstraints&&n.remoteSdp.remotePeerSdpConstraints.dontGetRemoteStream||n.dontAttachLocalStream||(t=r.beforeAddingStream(t,o))&&(i.getLocalStreams().forEach(function(e){t&&e.id==t.id&&(t=null)}),t)&&t.getTracks&&t.getTracks().forEach(function(e){try{i.addTrack(e,t)}catch(e){}})}),i.oniceconnectionstatechange=i.onsignalingstatechange=function(){var e=o.extra;r.peers[o.userid]&&(e=r.peers[o.userid].extra||e),i&&(n.onPeerStateChanged({iceConnectionState:i.iceConnectionState,iceGatheringState:i.iceGatheringState,signalingState:i.signalingState,extra:e,userid:o.userid}),i)&&i.iceConnectionState&&-1!==i.iceConnectionState.search(/closed|failed/gi)&&o.streams instanceof Array&&o.streams.forEach(function(e){e=r.streamEvents[e.id]||{streamid:e.id,stream:e,type:"remote"};r.onstreamended(e)})};var a={OfferToReceiveAudio:!!t.length,OfferToReceiveVideo:!!t.length},u=(n.localPeerSdpConstraints&&(a=n.localPeerSdpConstraints),C.sdpConstraints=fe(a),{}),c=(i.ontrack=function(t){var e;t&&"track"===t.type&&(t.stream=t.streams[t.streams.length-1],t.stream.id||(t.stream.id=t.track.id),u[t.stream.id]&&"Safari"!==DetectRTC.browser.name?t.track&&(t.track.onended=function(){i.onremovestream(t)}):(u[t.stream.id]=t.stream.id,e={},n.remoteSdp&&n.remoteSdp.streamsToShare?e=n.remoteSdp.streamsToShare:n.streamsToShare&&(e=n.streamsToShare),(e=e[t.stream.id])?(t.stream.isAudio=e.isAudio,t.stream.isVideo=e.isVideo,t.stream.isScreen=e.isScreen):(t.stream.isVideo=!!S(t.stream,"video").length,t.stream.isAudio=!t.stream.isVideo,t.stream.isScreen=!1),t.stream.streamid=t.stream.id,s[t.stream.id]=t.stream,n.onRemoteStream(t.stream),t.stream.getTracks().forEach(function(e){e.onended=function(){i.onremovestream(t)}}),t.stream.onremovetrack=function(){i.onremovestream(t)}))},i.onremovestream=function(e){e.stream.streamid=e.stream.id,s[e.stream.id]&&delete s[e.stream.id],n.onRemoteStreamRemoved(e.stream)},"function"!=typeof i.removeStream&&(i.removeStream=function(t){t.getTracks().forEach(function(e){i.removeTrack(e,t)})}),this.addRemoteCandidate=function(e){i.addIceCandidate(new he(e))},this.addRemoteSdp=function(t,n){n=n||function(){},"Safari"!==DetectRTC.browser.name&&(t.sdp=r.processSdp(t.sdp)),i.setRemoteDescription(new pe(t)).then(n,function(e){r.enableLogs&&console.error("setRemoteDescription failed","\n",e,"\n",t.sdp),n()}).catch(function(e){r.enableLogs&&console.error("setRemoteDescription failed","\n",e,"\n",t.sdp),n()})},!0);function d(t){t.binaryType="arraybuffer",t.onmessage=function(e){n.onDataChannelMessage(e.data)},t.onopen=function(){n.onDataChannelOpened(t)},t.onerror=function(e){n.onDataChannelError(e)},t.onclose=function(e){n.onDataChannelClosed(e)},t.internalSend=t.send,t.send=function(e){"open"===t.readyState&&t.internalSend(e)},i.channel=t}n.remoteSdp&&(c=!1),this.createDataChannel=function(){d(i.createDataChannel("sctp",{}))},!0!==r.session.data||e||(c?this.createDataChannel():i.ondatachannel=function(e){d(e.channel)}),this.enableDisableVideoEncoding=function(e){var t,n;i.getSenders().forEach(function(e){t||"video"!==e.track.kind||(t=e)}),t&&t.getParameters&&((n=t.getParameters()).encodings[1]&&(n.encodings[1].active=!!e),n.encodings[2]&&(n.encodings[2].active=!!e),t.setParameters(n))},n.remoteSdp&&(n.remoteSdp.remotePeerSdpConstraints&&(a=n.remoteSdp.remotePeerSdpConstraints),C.sdpConstraints=fe(a),this.addRemoteSdp(n.remoteSdp,function(){f("createAnswer")})),"two-way"!=r.session.audio&&"two-way"!=r.session.video&&"two-way"!=r.session.screen||(C.sdpConstraints=fe({OfferToReceiveAudio:"two-way"==r.session.audio||n.remoteSdp&&n.remoteSdp.remotePeerSdpConstraints&&n.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio,OfferToReceiveVideo:"two-way"==r.session.video||"two-way"==r.session.screen||n.remoteSdp&&n.remoteSdp.remotePeerSdpConstraints&&n.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio}));var l={};function f(e){i[e](C.sdpConstraints).then(function(e){"Safari"!==DetectRTC.browser.name&&(e.sdp=r.processSdp(e.sdp)),i.setLocalDescription(e).then(function(){r.trickleIce&&(n.onLocalSdp({type:e.type,sdp:e.sdp,remotePeerSdpConstraints:n.remotePeerSdpConstraints||!1,renegotiatingPeer:!!n.renegotiatingPeer||!1,connectionDescription:o.connectionDescription,dontGetRemoteStream:!!n.dontGetRemoteStream,extra:r?r.extra:{},streamsToShare:l}),r.onSettingLocalDescription(o))},function(e){r.enableLogs&&console.error("setLocalDescription error",e)})},function(e){r.enableLogs&&console.error("sdp-error",e)})}i.getLocalStreams().forEach(function(e){l[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}}),c&&f("createOffer"),i.nativeClose=i.close,i.close=function(){if(i){try{i.nativeClose!==i.close&&i.nativeClose()}catch(e){}i=null,o.peer=null}},this.peer=i}var T={removeVPX:function(e){var t=ge(e);return e=ye(e,"vp9",t,!0),ye(e,"vp8",t,!0)},disableNACK:function(e){if(e&&"string"==typeof e)return(e=(e=(e=e.replace("a=rtcp-fb:126 nack\r\n","")).replace("a=rtcp-fb:126 nack pli\r\n","a=rtcp-fb:126 pli\r\n")).replace("a=rtcp-fb:97 nack\r\n","")).replace("a=rtcp-fb:97 nack pli\r\n","a=rtcp-fb:97 pli\r\n");throw"Invalid arguments."},prioritize:function(r,e){if(e&&e.getSenders&&e.getSenders().length){if(!r||"string"!=typeof r)throw"Invalid arguments.";e.getSenders().forEach(function(e){for(var t=e.getParameters(),n=0;n<t.codecs.length;n++)if(t.codecs[n].mimeType==r){t.codecs.unshift(t.codecs.splice(n,1));break}e.setParameters(t)})}},removeNonG722:function(e){return e.replace(/m=audio ([0-9]+) RTP\/SAVPF ([0-9 ]*)/g,"m=audio $1 RTP/SAVPF 9")},setApplicationSpecificBandwidth:function(e,t,n){return e=e,n=n,!(t=t)||void 0!==Ce&&Ce||(n&&(t.screen?t.screen<300&&console.warn("It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail."):console.warn("It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.")),t.screen&&n&&(e=(e=e.replace(/b=AS([^\r\n]+\r\n)/g,"")).replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+t.screen+"\r\n")),(t.audio||t.video)&&(e=e.replace(/b=AS([^\r\n]+\r\n)/g,"")),t.audio&&(e=e.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:"+t.audio+"\r\n")),t.screen?e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+t.screen+"\r\n"):t.video&&(e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+t.video+"\r\n"))),e},setVideoBitrates:function(e,t){return e=e,o=(t=t||{}).min,t=t.max,i=e.split("\r\n"),s=A(i,"a=rtpmap","VP8/90000"),(n=s?be(i[s]):n)&&((s=A(i,"a=rtpmap","rtx/90000"))&&(r=be(i[s])),s)&&null!==(s=A(i,"a=fmtp:"+r.toString()))&&(r="\r\n",i[s]=i[s].concat(r+="a=fmtp:"+n+" x-google-min-bitrate="+(o||"228")+"; x-google-max-bitrate="+(t||"228")),e=i.join("\r\n")),e;var n,r,o,i,s},setOpusAttributes:function(e,t){return t=t||{},r=(e=e).split("\r\n"),o=A(r,"a=rtpmap","opus/48000"),!(n=o?be(r[o]):n)||null===(o=A(r,"a=fmtp:"+n.toString()))?e:(n="",n=(n+="; stereo="+(void 0!==t.stereo?t.stereo:"1"))+"; sprop-stereo="+(void 0!==t["sprop-stereo"]?t["sprop-stereo"]:"1"),void 0!==t.maxaveragebitrate&&(n+="; maxaveragebitrate="+(t.maxaveragebitrate||1048576)),void 0!==t.maxplaybackrate&&(n+="; maxplaybackrate="+(t.maxplaybackrate||1048576)),void 0!==t.cbr&&(n+="; cbr="+(void 0!==t.cbr?t.cbr:"1")),void 0!==t.useinbandfec&&(n+="; useinbandfec="+t.useinbandfec),void 0!==t.usedtx&&(n+="; usedtx="+t.usedtx),void 0!==t.maxptime&&(n+="\r\na=maxptime:"+t.maxptime),r[o]=r[o].concat(n),r.join("\r\n"));var n,r,o},preferVP9:function(e){return ve(e,"vp9")},preferCodec:ve,forceStereoAudio:function(e){for(var t=e.split("\r\n"),n=null,r=0;r<t.length;r++)if(-1!==t[r].search("opus/48000")){var o=extractSdp(t[r],/:(\d+) opus\/48000/i);break}for(r=0;r<t.length;r++)if(-1!==t[r].search("a=fmtp")&&extractSdp(t[r],/a=fmtp:(\d+)/)===o){n=r;break}return null===n?e:(t[n]=t[n].concat("; stereo=1; sprop-stereo=1"),t.join("\r\n"))}};function ve(e,t){var n=ge(e);return!n.videoCodecNumbers||"vp8"===t&&n.vp8LineNumber===n.videoCodecNumbers[0]||"vp9"===t&&n.vp9LineNumber===n.videoCodecNumbers[0]||"h264"===t&&n.h264LineNumber===n.videoCodecNumbers[0]?e:ye(e,t,n)}function ye(e,t,n,r){var o="";if("vp8"===t){if(!n.vp8LineNumber)return e;o=n.vp8LineNumber}if("vp9"===t){if(!n.vp9LineNumber)return e;o=n.vp9LineNumber}if("h264"===t){if(!n.h264LineNumber)return e;o=n.h264LineNumber}var t=n.videoCodecNumbersOriginal.split("SAVPF")[0]+"SAVPF ",i=r?[]:[o];return n.videoCodecNumbers.forEach(function(e){e!==o&&i.push(e)}),t+=i.join(" "),e.replace(n.videoCodecNumbersOriginal,t)}function ge(e){var n={};return e.split("\n").forEach(function(t){0===t.indexOf("m=video")&&(n.videoCodecNumbers=[],t.split("SAVPF")[1].split(" ").forEach(function(e){(e=e.trim())&&e.length&&(n.videoCodecNumbers.push(e),n.videoCodecNumbersOriginal=t)})),-1===t.indexOf("VP8/90000")||n.vp8LineNumber||(n.vp8LineNumber=t.replace("a=rtpmap:","").split(" ")[0]),-1===t.indexOf("VP9/90000")||n.vp9LineNumber||(n.vp9LineNumber=t.replace("a=rtpmap:","").split(" ")[0]),-1===t.indexOf("H264/90000")||n.h264LineNumber||(n.h264LineNumber=t.replace("a=rtpmap:","").split(" ")[0])}),n}function A(e,t,n){for(var r=e,o=t,i=n,s=r.length,a=0;a<s;++a)if(0===r[a].indexOf(o)&&(!i||-1!==r[a].toLowerCase().indexOf(i.toLowerCase())))return a;return null}function be(e){var t=new RegExp("a=rtpmap:(d+) w+/d+"),e=e.match(t);return e&&2===e.length?e[1]:null}window.BandwidthHandler=T;var we={processCandidates:function(e,t){var n=t.candidate,r=e.candidates,o=r.stun,i=r.turn;if(Y(r.reflexive)||(o=r.reflexive),Y(r.relay)||(i=r.relay),(r.host||!n.match(/typ host/g))&&(i||!n.match(/typ relay/g))&&(o||!n.match(/typ srflx/g))){r=e.iceProtocols;if((r.udp||!n.match(/ udp /g))&&(r.tcp||!n.match(/ tcp /g)))return e.enableLogs&&console.debug("Your candidate pairs:",n),{candidate:n,sdpMid:t.sdpMid,sdpMLineIndex:t.sdpMLineIndex}}}},u=function(e){return window.EJS_TURN_URLS};function ke(o){var i,t,n,r;function s(e,t){r=o.localMediaConstraints,n=e,r.mandatory&&r.mandatory.chromeMediaSource||r.mozMediaSource||r.mediaSource?n.isScreen=!0:r.video?n.isVideo=!0:r.audio&&(n.isAudio=!0);var n,r="ended";"oninactive"in e&&(r="inactive"),e.addEventListener(r,function(){delete currentUserMediaRequest.streams[i],currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.indexOf(o)&&(delete currentUserMediaRequest.queueRequests[currentUserMediaRequest.queueRequests.indexOf(o)],currentUserMediaRequest.queueRequests=z(currentUserMediaRequest.queueRequests))},!1),currentUserMediaRequest.streams[i]={stream:e},currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.length&&ke(currentUserMediaRequest.queueRequests.shift()),o.onGettingLocalMedia(e,t)}!0!==currentUserMediaRequest.mutex?(currentUserMediaRequest.mutex=!0,i=JSON.stringify(o.localMediaConstraints),currentUserMediaRequest.streams[i]?s(currentUserMediaRequest.streams[i].stream,!0):/BB10|BlackBerry/i.test(navigator.userAgent||"")||void 0===navigator.mediaDevices||"function"!=typeof navigator.mediaDevices.getUserMedia?(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia(o.localMediaConstraints,function(e){e.streamid=e.streamid||e.id||f(),e.idInstance=i,s(e)},function(e){o.onLocalMediaError(e,o.localMediaConstraints)})):(void 0===navigator.mediaDevices&&(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,r=function(){},navigator.mediaDevices={getUserMedia:function(e){return navigator.getUserMedia(e,function(e){e(stream),t=stream},function(e){r(e),n=e}),{then:function(e){if(!t)return{then:function(e){n?e(n):r=e}};e(t)}}}}),navigator.mediaDevices.getUserMedia(o.localMediaConstraints).then(function(e){e.streamid=e.streamid||e.id||f(),e.idInstance=i,s(e)}).catch(function(e){o.onLocalMediaError(e,o.localMediaConstraints)}))):currentUserMediaRequest.queueRequests.push(o)}window.currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[],remove:function(e){this.mutex=!1;var t=this.streams[e];t&&(t=t.stream.currentUserMediaRequestOptions,this.queueRequests.indexOf(t)&&(delete this.queueRequests[this.queueRequests.indexOf(t)],this.queueRequests=z(this.queueRequests)),this.streams[e].stream=null,delete this.streams[e])}};var x={setHandlers:function(r,o,i){var e;r&&r.addEventListener&&(void 0!==o&&1!=o||(e="ended","oninactive"in r&&(e="inactive"),r.addEventListener(e,function(){x.onSyncNeeded(this.streamid,e)},!1)),r.mute=function(e,t){e=Se(e),void 0!==t&&(o=t),void 0!==e&&"audio"!=e||S(r,"audio").forEach(function(e){e.enabled=!1,i.streamEvents[r.streamid].isAudioMuted=!0}),void 0!==e&&"video"!=e||S(r,"video").forEach(function(e){e.enabled=!1}),void 0!==o&&1!=o||x.onSyncNeeded(r.streamid,"mute",e),i.streamEvents[r.streamid].muteType=e||"both",F(r,"mute",e)},r.unmute=function(e,t){var n;e=Se(e),void 0!==t&&(o=t),i.streamEvents[r.streamid].mediaElement&&((n=i.streamEvents[r.streamid].mediaElement).volume=0,function e(t,n,r,o){n<=(o=(o||0)+1)||setTimeout(function(){r(),e(t,n,r,o)},t)}(200,5,function(){try{n.volume+=.2}catch(e){n.volume=1}})),void 0!==e&&"audio"!=e||S(r,"audio").forEach(function(e){e.enabled=!0,i.streamEvents[r.streamid].isAudioMuted=!1}),void 0!==e&&"video"!=e||(S(r,"video").forEach(function(e){e.enabled=!0}),void 0!==e&&"video"==e&&i.streamEvents[r.streamid].isAudioMuted&&function e(t){t=t||0,++t<100&&i.streamEvents[r.streamid].isAudioMuted&&(r.mute("audio"),setTimeout(function(){e(t)},50))}()),void 0!==o&&1!=o||x.onSyncNeeded(r.streamid,"unmute",e),i.streamEvents[r.streamid].unmuteType=e||"both",F(r,"unmute",e)})},onSyncNeeded:function(e,t,n){}};function Se(e){if(e)return"string"==typeof e||void 0===e?e:e.audio&&e.video?null:e.audio?"audio":e.video?"video":void 0}window.addEventListener("message",function(e){if(e.origin==window.location.origin){e=e.data;if("PermissionDeniedError"==e){if(_="PermissionDeniedError",P)return void P("PermissionDeniedError");throw new Error("PermissionDeniedError")}"rtcmulticonnection-extension-loaded"==e&&(_="desktop"),e.sourceId&&P&&P(O=e.sourceId,!0===e.canRequestAudioTrack)}});var O,P,_="screen";function Ee(e){if(e){if("desktop"==_)return e(!0);window.postMessage("are-you-there","*"),setTimeout(function(){e("screen"!=_)},2e3)}}var Ce=void 0!==window.InstallTrigger;window.opera||navigator.userAgent.indexOf(" OPR/");function Re(e,t){if(Ce)return t("not-chrome");2!=arguments.length&&(t=e,e="ajhifddimkapgcifgcodmmfdlknahffk");var n=document.createElement("img");n.src="chrome-extension://"+e+"/icon.png",n.onload=function(){_="screen",window.postMessage("are-you-there","*"),setTimeout(function(){t("screen"==_?"installed-disabled":"installed-enabled")},2e3)},n.onerror=function(){t("not-installed")}}function Te(s){var a={};return{receive:function(e,t,n){var r,o,i=e.uuid;a[i]||(a[i]=[]),a[i].push(e.message),e.last&&(r=a[i].join(""),o={data:r=e.isobject?JSON.parse(r):r,userid:t,extra:n,latency:(new Date).getTime()-e.sendingTime},s.autoTranslateText?(o.original=o.data,s.Translator.TranslateText(o.data,function(e){o.data=e,s.onmessage(o)})):s.onmessage(o),delete a[i])}}}window.chrome;var N,I,Ae,L,xe,Oe={send:function(e){var o=e.connection,i=e.channel,s=e.remoteUserId,e=e.text,a=o.chunkSize||1e3,c="",u=!1,d=("string"!=typeof e&&(u=!0,e=JSON.stringify(e)),f()),l=(new Date).getTime();!function e(t,n){var r={type:"text",uuid:d,sendingTime:l};t&&(n=t,r.packets=parseInt(n.length/a)),n.length>a?r.message=n.slice(0,a):(r.message=n,r.last=!0,r.isobject=u),i.send(r,s),(c=n.slice(r.message.length)).length&&setTimeout(function(){e(null,c)},o.chunkInterval||100)}(e)}},i={handle:function(n){var r={};n.onFileStart=function(e){var t=document.createElement("div");t.title=e.name,t.innerHTML="<label>0%</label> <progress></progress>",e.remoteUserId&&(t.innerHTML+=" (Sharing with:"+e.remoteUserId+")"),n.filesContainer||(n.filesContainer=document.body||document.documentElement),n.filesContainer.insertBefore(t,n.filesContainer.firstChild),e.remoteUserId?(r[e.uuid]||(r[e.uuid]={}),r[e.uuid][e.remoteUserId]={div:t,progress:t.querySelector("progress"),label:t.querySelector("label")},r[e.uuid][e.remoteUserId].progress.max=e.maxChunks):(r[e.uuid]={div:t,progress:t.querySelector("progress"),label:t.querySelector("label")},r[e.uuid].progress.max=e.maxChunks)},n.onFileProgress=function(e){var t=r[e.uuid];!t||e.remoteUserId&&!(t=r[e.uuid][e.remoteUserId])||(t.progress.value=e.currentPosition||e.maxChunks||t.progress.max,e=t.progress,t=t.label,-1!==e.position&&(e=+e.position.toFixed(2).split(".")[1]||100,t.innerHTML=e+"%"))},n.onFileEnd=function(e){var t=r[e.uuid];t?e.remoteUserId&&!(t=r[e.uuid][e.remoteUserId])||(t=t.div,-1!=e.type.indexOf("image")?t.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><img src="'+e.url+'" title="'+e.name+'" style="max-width: 80%;">':t.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><iframe src="'+e.url+'" title="'+e.name+'" style="width: 80%;border: 0;height: inherit;margin-top:1em;"></iframe>'):console.error("No such progress-helper element exist.",e)}}},t={handle:function(o){o.autoTranslateText=!1,o.language="en",o.googKey="AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE",o.Translator={TranslateText:function(e,t){var n=document.createElement("script"),e=(n.type="text/javascript",encodeURIComponent(e)),r="method"+o.token(),r=(window[r]=function(e){e.data&&e.data.translations[0]&&t?t(e.data.translations[0].translatedText):e.error&&"Daily Limit Exceeded"===e.error.message?console.error('Text translation failed. Error message: "Daily Limit Exceeded."'):e.error?console.error(e.error.message):console.error(e)},"https://www.googleapis.com/language/translate/v2?key="+o.googKey+"&target="+(o.language||"en-US")+"&callback=window."+r+"&q="+e);n.src=r,document.getElementsByTagName("head")[0].appendChild(n)},getListOfLanguages:function(t){var n=new XMLHttpRequest,e=(n.onreadystatechange=function(){var e;n.readyState==XMLHttpRequest.DONE&&((e=JSON.parse(n.responseText))&&e.data&&e.data.languages?t(e.data.languages):e.error&&"Daily Limit Exceeded"===e.error.message?console.error('Text translation failed. Error message: "Daily Limit Exceeded."'):e.error?console.error(e.error.message):console.error(e))},"https://www.googleapis.com/language/translate/v2/languages?key="+o.googKey+"&target=en");n.open("GET",e,!0),n.send(null)}}}};function M(t){if(N.socketAutoReConnect=!0,N.socket)t&&t(N.socket);else{if(void 0===n)if("undefined"!=typeof FirebaseConnection)window.SocketConnection=FirebaseConnection;else{if("undefined"==typeof PubNubConnection)throw"SocketConnection.js seems missed.";window.SocketConnection=PubNubConnection}new n(N,function(e){t&&t(N.socket)})}}function Pe(n,r){N.socket.emit("join-room",{sessionid:N.sessionid,session:N.session,mediaConstraints:N.mediaConstraints,sdpConstraints:N.sdpConstraints,streams:Ne(),extra:N.extra,password:void 0!==N.password&&"object"!==Be(N.password)?N.password:""},function(e,t){if(!0===e){if(N.enableLogs&&console.log("isRoomJoined: ",e," roomid: ",N.sessionid),N.peers[N.sessionid])return;I.onNegotiationNeeded(n)}!1===e&&N.enableLogs&&console.warn("isRoomJoined: ",t," roomid: ",N.sessionid),r(e,N.sessionid,t)})}function _e(n){N.enableLogs&&console.log("Sending open-room signal to socket.io"),N.waitingForLocalMedia=!1,N.socket.emit("open-room",{sessionid:N.sessionid,session:N.session,mediaConstraints:N.mediaConstraints,sdpConstraints:N.sdpConstraints,streams:Ne(),extra:N.extra,identifier:N.publicRoomIdentifier,password:void 0!==N.password&&"object"!==Be(N.password)?N.password:""},function(e,t){!0===e&&(N.enableLogs&&console.log("isRoomOpened: ",e," roomid: ",N.sessionid),n(e,N.sessionid)),!1===e&&(N.enableLogs&&console.warn("isRoomOpened: ",t," roomid: ",N.sessionid),n(e,N.sessionid,t))})}function Ne(){try{return N.streamEvents.selectAll("local").map(function(e){return{streamid:e.streamid,tracks:e.stream.getTracks().length}})}catch(e){return[]}}function Ie(e,n){var r;N.dontCaptureUserMedia||e.isDataOnly||(e.localPeerSdpConstraints.OfferToReceiveAudio&&N.mediaConstraints.audio,e.localPeerSdpConstraints.OfferToReceiveVideo&&N.mediaConstraints.video,(r=e.session||N.session).oneway&&"two-way"!==r.audio&&"two-way"!==r.video&&"two-way"!==r.screen)?n():((r=r.oneway&&r.audio&&"two-way"===r.audio?{audio:!0}:r).audio||r.video||r.screen)&&(r.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:k(N)}).then(function(e){e.isScreen=!0,I.onGettingLocalMedia(e),!r.audio&&!r.video||k(N)?n(e):N.invokeGetUserMedia(null,n)},function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):N.getScreenConstraints(function(e,t){N.invokeGetUserMedia({audio:!!k(N)&&de(t),video:t,isScreen:!0},!r.audio&&!r.video||k(N)?n:N.invokeGetUserMedia(null,n))}):(r.audio||r.video)&&N.invokeGetUserMedia(null,n,r))}function Le(e,t){e?(t.audio&&S(e,"audio").forEach(function(e){e.applyConstraints(t.audio)}),t.video&&S(e,"video").forEach(function(e){e.applyConstraints(t.video)})):N.enableLogs&&console.error("No stream to applyConstraints.")}function Me(t,e,n){e?I.replaceTrack(t,e,n):N.peers.getAllParticipants().forEach(function(e){I.replaceTrack(t,e,n)})}j=j||{useDefaultDevices:!0},(N=this).channel=N.sessionid=(D||location.href.replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g,"").split("\n").join("").split("\r").join(""))+"",I=new U(N),Ae={},I.onGettingLocalMedia=function(t,o){if(o=o||function(){},Ae[t.streamid])o();else{Ae[t.streamid]=!0;try{t.type="local"}catch(e){}N.setStreamEndHandler(t),V(t,function(e){e.id=t.streamid,e.muted=!0,e.volume=0,-1===N.attachStreams.indexOf(t)&&N.attachStreams.push(t),void 0!==x&&x.setHandlers(t,!0,N),N.streamEvents[t.streamid]={stream:t,type:"local",mediaElement:e,userid:N.userid,extra:N.extra,streamid:t.streamid,isAudioMuted:!0};try{var n=N,r=N.streamEvents[t.streamid];if(r.stream&&S(r.stream,"audio").length){if(!n||!r)throw"Both arguments are required.";if(n.onspeaking&&n.onsilence){if("undefined"==typeof hark)throw"hark.js not found.";hark(r.stream,{onspeaking:function(){n.onspeaking(r)},onsilence:function(){n.onsilence(r)},onvolumechange:function(e,t){n.onvolumechange&&n.onvolumechange(qe({volume:e,threshold:t},r))}})}}q(N,N.streamEvents[t.streamid]),N.onstream(N.streamEvents[t.streamid])}catch(e){}o()},N)}},I.onGettingRemoteMedia=function(t,n){try{t.type="remote"}catch(e){}N.setStreamEndHandler(t,"remote-stream"),V(t,function(e){e.id=t.streamid,void 0!==x&&x.setHandlers(t,!1,N),N.streamEvents[t.streamid]={stream:t,type:"remote",userid:n,extra:N.peers[n]?N.peers[n].extra:{},mediaElement:e,streamid:t.streamid},q(N,N.streamEvents[t.streamid]),N.onstream(N.streamEvents[t.streamid])},N)},I.onRemovingRemoteMedia=function(e,t){var n=(n=N.streamEvents[e.streamid])||{stream:e,type:"remote",userid:t,extra:N.peers[t]?N.peers[t].extra:{},streamid:e.streamid,mediaElement:N.streamEvents[e.streamid]?N.streamEvents[e.streamid].mediaElement:null};N.peersBackup[n.userid]&&(n.extra=N.peersBackup[n.userid].extra),N.onstreamended(n),delete N.streamEvents[e.streamid]},I.onNegotiationNeeded=function(e,t,n){n=n||function(){};var r={remoteUserId:t=t||e.remoteUserId,message:e=e||"",sender:N.userid};e.remoteUserId&&e.message&&e.sender&&(r=e),M(function(){N.socket.emit(N.socketMessageEvent,r,n)})},I.onUserLeft=function(e){N.deletePeer(e)},I.disconnectWith=function(e,t){N.socket&&N.socket.emit("disconnect-with",e,t||function(){}),N.deletePeer(e)},N.socketOptions={transport:"polling"},N.openOrJoin=function(e,s){s=s||function(){},N.checkPresence(e,function(e,t){var n,r,o,i;e?(N.sessionid=t,e=!!N.session.oneway,n=c(N.session),r={OfferToReceiveAudio:N.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:N.sdpConstraints.mandatory.OfferToReceiveVideo},o={OfferToReceiveAudio:e?!!N.session.audio:N.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:e?!!N.session.video||!!N.session.screen:N.sdpConstraints.mandatory.OfferToReceiveVideo},Ie((i={remoteUserId:N.sessionid,message:{newParticipationRequest:!0,isOneWay:e,isDataOnly:n,localPeerSdpConstraints:o,remotePeerSdpConstraints:r},sender:N.userid}).message,function(){Pe(i,s)})):(N.waitingForLocalMedia=!0,N.isInitiator=!0,N.sessionid=t||N.sessionid,c(N.session)?_e(s):N.captureUserMedia(function(){_e(s)}))})},N.waitingForLocalMedia=!1,N.open=function(e,t){t=t||function(){},N.waitingForLocalMedia=!0,N.isInitiator=!0,N.sessionid=e||N.sessionid,M(function(){c(N.session)?_e(t):N.captureUserMedia(function(){_e(t)})})},N.peersBackup={},N.deletePeer=function(e){if(e&&N.peers[e]){var t={userid:e,extra:N.peers[e]?N.peers[e].extra:{}};if(N.peersBackup[t.userid]&&(t.extra=N.peersBackup[t.userid].extra),N.onleave(t),N.peers[e]){N.peers[e].streams.forEach(function(e){e.stop()});t=N.peers[e].peer;if(t&&"closed"!==t.iceConnectionState)try{t.close()}catch(e){}N.peers[e]&&(N.peers[e].peer=null,delete N.peers[e])}}},N.rejoin=function(e){var t;!N.isInitiator&&e&&Object.keys(e).length&&(t={},N.peers[e.remoteUserId]&&(t=N.peers[e.remoteUserId].extra,N.deletePeer(e.remoteUserId)),e)&&e.remoteUserId&&(N.join(e.remoteUserId),N.onReConnecting({userid:e.remoteUserId,extra:t}))},N.join=function(e,t){N.sessionid=!!e&&(e.sessionid||e.remoteUserId||e)||N.sessionid,N.sessionid+="";var n=!1,r=!1,o=!1,i=!1,s=((e&&e.session||!e||"string"==typeof e)&&(o=!!(e=e&&e.session||N.session).oneway,i=c(e),r={OfferToReceiveAudio:N.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:N.sdpConstraints.mandatory.OfferToReceiveVideo},n={OfferToReceiveAudio:o?!!N.session.audio:N.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:o?!!N.session.video||!!N.session.screen:N.sdpConstraints.mandatory.OfferToReceiveVideo}),function(){}),a=("function"==typeof(t=t||{})&&(s=t,t={}),void 0!==t.localPeerSdpConstraints&&(n=t.localPeerSdpConstraints),void 0!==t.remotePeerSdpConstraints&&(r=t.remotePeerSdpConstraints),void 0!==t.isOneWay&&(o=t.isOneWay),void 0!==t.isDataOnly&&(i=t.isDataOnly),{remoteUserId:N.sessionid,message:{newParticipationRequest:!0,isOneWay:o,isDataOnly:i,localPeerSdpConstraints:n,remotePeerSdpConstraints:r},sender:N.userid});return Ie(a.message,function(){M(function(){Pe(a,s)})}),a},N.publicRoomIdentifier="",N.getUserMedia=N.captureUserMedia=function(r,o){r=r||function(){};var i=o||N.session;N.dontCaptureUserMedia||c(i)?r():(i.audio||i.video||i.screen)&&(i.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:k(N)}).then(function(e){if(e.isScreen=!0,I.onGettingLocalMedia(e),!i.audio&&!i.video||k(N))r(e);else{var t,n={};for(t in i)"screen"!==t&&(n[t]=i[t]);N.invokeGetUserMedia(o,r,n)}},function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):N.getScreenConstraints(function(e,t){if(e)throw e;N.invokeGetUserMedia({audio:!!k(N)&&de(t),video:t,isScreen:!0},function(e){if(!i.audio&&!i.video||k(N))r(e);else{var t,n={};for(t in i)"screen"!==t&&(n[t]=i[t]);N.invokeGetUserMedia(o,r,n)}})}):(i.audio||i.video)&&N.invokeGetUserMedia(o,r,i))},N.onbeforeunload=function(e,t){N.closeBeforeUnload&&(N.peers.getAllParticipants().forEach(function(e){I.onNegotiationNeeded({userLeft:!0},e),N.peers[e]&&N.peers[e].peer&&N.peers[e].peer.close(),delete N.peers[e]}),t||N.closeSocket(),N.isInitiator=!1)},window.ignoreBeforeUnload?N.closeBeforeUnload=!1:(N.closeBeforeUnload=!0,window.addEventListener("beforeunload",N.onbeforeunload,!1)),N.userid=f(),N.changeUserId=function(e,t){t=t||function(){},N.userid=e||f(),N.socket.emit("changed-uuid",N.userid,t)},N.extra={},N.attachStreams=[],N.session={audio:!0,video:!0},N.enableFileSharing=!1,N.bandwidth={screen:!1,audio:!1,video:!1},N.codecs={audio:"opus",video:"VP9"},N.processSdp=function(e){return function(){var t=!1;try{if("undefined"==typeof RTCRtpTransceiver)return;if(!("currentDirection"in RTCRtpTransceiver.prototype))return;var e=new E;try{e.addTransceiver("audio"),t=!0}catch(e){}e.close()}catch(e){t=!1}return t&&function(){var t=!1;try{var e=new E({sdpSemantics:"unified-plan"});try{var n=e.getConfiguration(),t="unified-plan"==n.sdpSemantics||(n.sdpSemantics,!1)}catch(e){t=!1}}catch(e){t=!1}return t}()}()||"Safari"!==DetectRTC.browser.name&&("VP8"===N.codecs.video.toUpperCase()&&(e=T.preferCodec(e,"vp8")),"VP9"===N.codecs.video.toUpperCase()&&(e=T.preferCodec(e,"vp9")),"H264"===N.codecs.video.toUpperCase()&&(e=T.preferCodec(e,"h264")),"G722"===N.codecs.audio&&(e=T.removeNonG722(e)),"Firefox"!==DetectRTC.browser.name)&&((N.bandwidth.video||N.bandwidth.screen)&&(e=T.setApplicationSpecificBandwidth(e,N.bandwidth,!!N.session.screen)),N.bandwidth.video&&(e=T.setVideoBitrates(e,{min:8*N.bandwidth.video*1024,max:8*N.bandwidth.video*1024})),N.bandwidth.audio)&&(e=T.setOpusAttributes(e,{maxaveragebitrate:8*N.bandwidth.audio*1024,maxplaybackrate:8*N.bandwidth.audio*1024,stereo:1,maxptime:3})),e},void 0!==T&&(N.BandwidthHandler=N.CodecsHandler=T),N.mediaConstraints={audio:{mandatory:{},optional:N.bandwidth.audio?[{bandwidth:8*N.bandwidth.audio*1024||1048576}]:[]},video:{mandatory:{},optional:N.bandwidth.video?[{bandwidth:8*N.bandwidth.video*1024||1048576},{facingMode:"user"}]:[{facingMode:"user"}]}},"Firefox"===DetectRTC.browser.name&&(N.mediaConstraints={audio:!0,video:!0}),j.useDefaultDevices||DetectRTC.isMobileDevice||DetectRTC.load(function(){var t,n;if(DetectRTC.MediaDevices.forEach(function(e){"audioinput"===e.kind&&!1!==N.mediaConstraints.audio&&(t=e),"videoinput"===e.kind&&!1!==N.mediaConstraints.video&&(n=e)}),t){if("Firefox"===DetectRTC.browser.name)return void(!0!==N.mediaConstraints.audio?N.mediaConstraints.audio.deviceId=t.id:N.mediaConstraints.audio={deviceId:t.id});1==N.mediaConstraints.audio&&(N.mediaConstraints.audio={mandatory:{},optional:[]}),N.mediaConstraints.audio.optional||(N.mediaConstraints.audio.optional=[]);var e=[{sourceId:t.id}];N.mediaConstraints.audio.optional=e.concat(N.mediaConstraints.audio.optional)}n&&("Firefox"===DetectRTC.browser.name?!0!==N.mediaConstraints.video?N.mediaConstraints.video.deviceId=n.id:N.mediaConstraints.video={deviceId:n.id}:(1==N.mediaConstraints.video&&(N.mediaConstraints.video={mandatory:{},optional:[]}),N.mediaConstraints.video.optional||(N.mediaConstraints.video.optional=[]),e=[{sourceId:n.id}],N.mediaConstraints.video.optional=e.concat(N.mediaConstraints.video.optional)))}),N.sdpConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},optional:[{VoiceActivityDetection:!1}]},N.sdpSemantics=null,N.iceCandidatePoolSize=null,N.bundlePolicy=null,N.rtcpMuxPolicy=null,N.iceTransportPolicy=null,N.optionalArgument={optional:[{DtlsSrtpKeyAgreement:!0},{googImprovedWifiBwe:!0},{googScreencastMinBitrate:300},{googIPv6:!0},{googDscp:!0},{googCpuUnderuseThreshold:55},{googCpuOveruseThreshold:85},{googSuspendBelowMinBitrate:!0},{googCpuOveruseDetection:!0}],mandatory:{}},N.iceServers=u(N),N.candidates={host:!0,stun:!0,turn:!0},N.iceProtocols={tcp:!0,udp:!0},N.onopen=function(e){N.enableLogs&&console.info("Data connection has been opened between you & ",e.userid)},N.onclose=function(e){N.enableLogs&&console.warn("Data connection has been closed between you & ",e.userid)},N.onerror=function(e){N.enableLogs&&console.error(e.userid,"data-error",e)},N.onmessage=function(e){N.enableLogs&&console.debug("data-message",e.userid,e.data)},N.send=function(e,t){N.peers.send(e,t)},N.close=N.disconnect=N.leave=function(){N.onbeforeunload(!1,!0)},N.closeEntireSession=function(t){t=t||function(){},N.socket.emit("close-entire-session",function e(){N.getAllParticipants().length?setTimeout(e,100):(N.onEntireSessionClosed({sessionid:N.sessionid,userid:N.userid,extra:N.extra}),N.changeUserId(null,function(){N.close(),t()}))})},N.onEntireSessionClosed=function(e){N.enableLogs&&console.info("Entire session is closed: ",e.sessionid,e.extra)},N.onstream=function(e){var t=N.videosContainer,t=(t.insertBefore(e.mediaElement,t.firstChild),e.mediaElement.play());void 0===t?setTimeout(function(){e.mediaElement.play()},2e3):t.catch(function(){}).then(function(){setTimeout(function(){e.mediaElement.play()},2e3)})},N.onstreamended=function(e){e.mediaElement||(e.mediaElement=document.getElementById(e.streamid)),e.mediaElement&&e.mediaElement.parentNode&&e.mediaElement.parentNode.removeChild(e.mediaElement)},N.direction="many-to-many",N.removeStream=function(t,n){var r;N.attachStreams.forEach(function(e){e.id===t&&(r=e)}),r?(N.peers.getAllParticipants().forEach(function(e){if(!n||e===n){e=N.peers[e];try{e.peer.removeStream(r)}catch(e){}}}),N.renegotiate()):console.warn("No such stream exist.",t)},N.addStream=function(n,t){function r(e){n.streamCallback&&n.streamCallback(e),N.renegotiate(t)}n.getTracks?(-1===N.attachStreams.indexOf(n)&&(n.streamid||(n.streamid=n.id),N.attachStreams.push(n)),N.renegotiate(t)):c(n)?N.renegotiate(t):(n.audio||n.video||n.screen)&&(n.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:k(N)}).then(function(e){e.isScreen=!0,I.onGettingLocalMedia(e),!n.audio&&!n.video||k(N)?r(e):N.invokeGetUserMedia(null,function(e){r(e)})},function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):N.getScreenConstraints(function(e,t){if(e)return"PermissionDeniedError"===e?(n.streamCallback&&n.streamCallback(null),void(N.enableLogs&&console.error("User rejected to share his screen."))):alert(e);N.invokeGetUserMedia({audio:!!k(N)&&de(t),video:t,isScreen:!0},function(e){!n.audio&&!n.video||k(N)?r(e):N.invokeGetUserMedia(null,function(e){r(e)})})}):(n.audio||n.video)&&N.invokeGetUserMedia(null,r))},N.invokeGetUserMedia=function(n,r,e){e=e||N.session,ke({onGettingLocalMedia:function(e){var t=n.video;t&&(t.mediaSource||t.mozMediaSource||t.mandatory&&t.mandatory.chromeMediaSource)&&(e.isScreen=!0),e.isScreen||(e.isVideo=!!S(e,"video").length,e.isAudio=!e.isVideo&&S(e,"audio").length),I.onGettingLocalMedia(e,function(){"function"==typeof r&&r(e)})},onLocalMediaError:function(e,t){I.onLocalMediaError(e,t)},localMediaConstraints:(n=n||N.mediaConstraints)||{audio:!!e.audio&&n.audio,video:!!e.video&&n.video}})},N.applyConstraints=function(t,e){var n;R&&R.prototype.applyConstraints?e?Le(n=N.streamEvents[e]?N.streamEvents[e].stream:n,t):N.attachStreams.forEach(function(e){Le(e,t)}):alert("track.applyConstraints is NOT supported in your browser.")},N.replaceTrack=function(n,t,r){if(n=n||{},E.prototype.getSenders)if(n instanceof R)Me(n,t,r);else if(n instanceof w)S(n,"video").length&&Me(S(n,"video")[0],t,!0),S(n,"audio").length&&Me(S(n,"audio")[0],t,!1);else{if(c(n))throw"connection.replaceTrack requires audio and/or video and/or screen.";(n.audio||n.video||n.screen)&&(n.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:k(N)}).then(function(e){e.isScreen=!0,I.onGettingLocalMedia(e),!n.audio&&!n.video||k(N)?o(e):N.invokeGetUserMedia(null,o)},function(e){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):N.getScreenConstraints(function(e,t){if(e)return alert(e);N.invokeGetUserMedia({audio:!!k(N)&&de(t),video:t,isScreen:!0},!n.audio&&!n.video||k(N)?o:N.invokeGetUserMedia(null,o))}):(n.audio||n.video)&&N.invokeGetUserMedia(null,o))}else N.addStream(n);function o(e){N.replaceTrack(e,t,r||n.video||n.screen)}},N.resetTrack=function(e,n){(e="string"==typeof(e=e||N.getAllParticipants())?[e]:e).forEach(function(e){var t=N.peers[e].peer;void 0!==n&&!0!==n||!t.lastVideoTrack||N.replaceTrack(t.lastVideoTrack,e,!0),void 0!==n&&!1!==n||!t.lastAudioTrack||N.replaceTrack(t.lastAudioTrack,e,!1)})},N.renegotiate=function(e){e?I.renegotiatePeer(e):N.peers.getAllParticipants().forEach(function(e){I.renegotiatePeer(e)})},N.setStreamEndHandler=function(r,o){var e;r&&r.addEventListener&&(o=!!o,!r.alreadySetEndHandler)&&(r.alreadySetEndHandler=!0,e="ended","oninactive"in r&&(e="inactive"),r.addEventListener(e,function(){r.idInstance&&currentUserMediaRequest.remove(r.idInstance),o||(t=[],N.attachStreams.forEach(function(e){e.id!=r.id&&t.push(e)}),N.attachStreams=t);var e,t,n=(n=N.streamEvents[r.streamid])||{stream:r,streamid:r.streamid,type:o?"remote":"local",userid:N.userid,extra:N.extra,mediaElement:N.streamEvents[r.streamid]?N.streamEvents[r.streamid].mediaElement:null};o&&N.peers[n.userid]&&(e=N.peers[n.userid].peer,t=[],e.getRemoteStreams().forEach(function(e){e.id!=r.id&&t.push(e)}),N.peers[n.userid].streams=t),n.userid===N.userid&&"remote"===n.type||(N.peersBackup[n.userid]&&(n.extra=N.peersBackup[n.userid].extra),N.onstreamended(n),delete N.streamEvents[r.streamid])},!1))},N.onMediaError=function(e,t){N.enableLogs&&console.error(e,t)},N.autoCloseEntireSession=!1,N.filesContainer=N.videosContainer=document.body||document.documentElement,N.isInitiator=!1,N.shareFile=I.shareFile,i.handle(N),t.handle(N),N.token=f,N.onNewParticipant=function(e,t){N.acceptParticipationRequest(e,t)},N.acceptParticipationRequest=function(e,t){t.successCallback&&(t.successCallback(),delete t.successCallback),I.createNewPeer(e,t)},void 0!==x&&(N.StreamsHandler=x),N.onleave=function(e){},N.invokeSelectFileDialog=function(e){var t=new Fe;t.accept="*.*",t.selectSingleFile(e)},N.onmute=function(e){var t;e&&e.mediaElement&&("both"===e.muteType||"video"===e.muteType?(e.mediaElement.src=null,void 0!==(t=e.mediaElement.pause())?t.then(function(){e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"}):e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"):"audio"===e.muteType&&(e.mediaElement.muted=!0))},N.onunmute=function(e){e&&e.mediaElement&&e.stream&&("both"===e.unmuteType||"video"===e.unmuteType?(e.mediaElement.poster=null,e.mediaElement.srcObject=e.stream,e.mediaElement.play()):"audio"===e.unmuteType&&(e.mediaElement.muted=!1))},N.onExtraDataUpdated=function(e){e.status="online",N.onUserStatusChanged(e,!0)},N.getAllParticipants=function(e){return N.peers.getAllParticipants(e)},void 0!==x&&(x.onSyncNeeded=function(t,n,r){N.peers.getAllParticipants().forEach(function(e){I.onNegotiationNeeded({streamid:t,action:n,streamSyncNeeded:!0,type:r||"both"},e)})}),N.connectSocket=function(e){M(e)},N.closeSocket=function(){try{_0x31267b.a.sockets={}}catch(e){}N.socket&&("function"==typeof N.socket.disconnect&&N.socket.disconnect(),"function"==typeof N.socket.resetProps&&N.socket.resetProps(),N.socket=null)},N.getSocket=function(e){return!e&&N.enableLogs&&console.warn("getSocket.callback paramter is required."),e=e||function(){},N.socket?e(N.socket):M(function(){e(N.socket)}),N.socket},N.getRemoteStreams=I.getRemoteStreams,xe=["selectFirst","selectAll","forEach"],N.streamEvents={selectFirst:function(e){return N.streamEvents.selectAll(e)[0]},selectAll:function(n){"video"==(n="audio"==(n="screen"==(n="remote"==(n="local"==(n=n||{local:!0,remote:!0,isScreen:!0,isAudio:!0,isVideo:!0})?{local:!0}:n)?{remote:!0}:n)?{isScreen:!0}:n)?{isAudio:!0}:n)&&(n={isVideo:!0});var r=[];return Object.keys(N.streamEvents).forEach(function(e){var t=N.streamEvents[e];-1===xe.indexOf(e)&&(e=!0,n.local&&"local"===t.type&&(e=!1),n.remote&&"remote"===t.type&&(e=!1),n.isScreen&&t.stream.isScreen&&(e=!1),n.isVideo&&t.stream.isVideo&&(e=!1),n.isAudio&&t.stream.isAudio&&(e=!1),!1===(e=n.userid&&t.userid===n.userid?!1:e))&&r.push(t)}),r}},N.socketURL="/",N.socketMessageEvent="RTCMultiConnection-Message",N.socketCustomEvent="RTCMultiConnection-Custom-Message",N.DetectRTC=DetectRTC,N.setCustomSocketEvent=function(e){e&&(N.socketCustomEvent=e),N.socket&&N.socket.emit("set-custom-socket-event-listener",N.socketCustomEvent)},N.getNumberOfBroadcastViewers=function(e,t){N.socket&&e&&t&&N.socket.emit("get-number-of-users-in-specific-broadcast",e,t)},N.onNumberOfBroadcastViewersUpdated=function(e){N.enableLogs&&N.isInitiator&&console.info("Number of broadcast (",e.broadcastId,") viewers",e.numberOfBroadcastViewers)},N.onUserStatusChanged=function(e,t){N.enableLogs&&!t&&console.info(e.userid,e.status)},N.getUserMediaHandler=ke,N.multiPeersHandler=I,N.enableLogs=!0,N.setCustomSocketHandler=function(e){void 0!==n&&(n=e)},N.chunkSize=4e4,N.maxParticipantsAllowed=1e3,N.disconnectWith=I.disconnectWith,N.checkPresence=function(e,r){e=e||N.sessionid,"SSEConnection"!==n.name?N.socket?N.socket.emit("check-presence",e+"",function(e,t,n){N.enableLogs&&console.log("checkPresence.isRoomExist: ",e," roomid: ",t),r(e,t,n)}):N.connectSocket(function(){N.checkPresence(e,r)}):SSEConnection.checkPresence(e,function(e,t,n){N.socket?r(e,t):(e||(N.userid=t),N.connectSocket(function(){r(e,t,n)}))})},N.onReadyForOffer=function(e,t){N.multiPeersHandler.createNewPeer(e,t)},N.setUserPreferences=function(e){return N.dontAttachStream&&(e.dontAttachLocalStream=!0),N.dontGetRemoteStream&&(e.dontGetRemoteStream=!0),e},N.updateExtraData=function(){N.socket.emit("extra-data-updated",N.extra)},N.enableScalableBroadcast=!1,N.maxRelayLimitPerUser=3,N.dontCaptureUserMedia=!1,N.dontAttachStream=!1,N.dontGetRemoteStream=!1,N.onReConnecting=function(e){N.enableLogs&&console.info("ReConnecting with",e.userid,"...")},N.beforeAddingStream=function(e){return e},N.beforeRemovingStream=function(e){return e},N.checkIfChromeExtensionAvailable=Ee,"undefined"!=typeof isFirefoxExtensionAvailable&&(N.checkIfChromeExtensionAvailable=isFirefoxExtensionAvailable),N.getChromeExtensionStatus=Re,N.getScreenConstraints=function(n,e){k(N,e)&&(e=!0);var r,o=function(e,t){e||(t=N.modifyScreenConstraints(t),n(e,t))};Ce?o(null,{mozMediaSource:"window",mediaSource:"window"}):(r={mandatory:{chromeMediaSource:_,maxWidth:1920<screen.width?screen.width:1920,maxHeight:1080<screen.height?screen.height:1080},optional:[]},"desktop"!=_||O?("desktop"==_&&(r.mandatory.chromeMediaSourceId=O),o(null,r)):e?(e=function(e,t){r.mandatory.chromeMediaSourceId=e,t&&(r.canRequestAudioTrack=!0),o("PermissionDeniedError"==e?e:null,r)},O?e(O):(P=e,window.postMessage("audio-plus-tab","*"))):(e=function(e){r.mandatory.chromeMediaSourceId=e,o("PermissionDeniedError"==e?e:null,r)},O?e(O):(P=e,window.postMessage("get-sourceId","*"))))},N.modifyScreenConstraints=function(e){return e},N.onPeerStateChanged=function(e){N.enableLogs&&-1!==e.iceConnectionState.search(/closed|failed/gi)&&console.error("Peer connection is closed between you & ",e.userid,e.extra,"state:",e.iceConnectionState)},N.isOnline=!0,W("online",function(){N.isOnline=!0}),W("offline",function(){N.isOnline=!1}),N.isLowBandwidth=!1,navigator&&navigator.connection&&navigator.connection.type&&(N.isLowBandwidth=-1!==navigator.connection.type.toString().toLowerCase().search(/wifi|cell/g),N.isLowBandwidth)&&(N.bandwidth={audio:!1,video:!1,screen:!1},N.mediaConstraints.audio&&N.mediaConstraints.audio.optional&&N.mediaConstraints.audio.optional.length&&(L=[],N.mediaConstraints.audio.optional.forEach(function(e){void 0===e.bandwidth&&L.push(e)}),N.mediaConstraints.audio.optional=L),N.mediaConstraints.video&&N.mediaConstraints.video.optional&&N.mediaConstraints.video.optional.length&&(L=[],N.mediaConstraints.video.optional.forEach(function(e){void 0===e.bandwidth&&L.push(e)}),N.mediaConstraints.video.optional=L)),N.getExtraData=function(e,r){if(!e)throw"remoteUserId is required.";if(!r)return N.peers[e]?N.peers[e].extra:N.peersBackup[e]?N.peersBackup[e].extra:{};N.socket.emit("get-remote-user-extra-data",e,function(e,t,n){r(e,t,n)})},j.autoOpenOrJoin&&N.openOrJoin(N.sessionid),N.onUserIdAlreadyTaken=function(e,t){N.close(),N.closeSocket(),N.isInitiator=!1,N.userid=N.token(),N.join(N.sessionid),N.enableLogs&&console.warn("Userid already taken.",e,"Your new userid:",N.userid)},N.trickleIce=!0,N.version="3.6.5",N.onSettingLocalDescription=function(e){N.enableLogs&&console.info("Set local description for remote user",e.userid)},N.resetScreen=function(){O=null,DetectRTC&&DetectRTC.screen&&delete DetectRTC.screen.sourceId,currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[]}},N.autoCreateMediaElement=!0,N.password=null,N.setPassword=function(e,t){t=t||function(){},N.socket?N.socket.emit("set-password",e,t):(N.password=e,t(!0,N.sessionid,null))},N.errors={ROOM_NOT_AVAILABLE:"Room not available",INVALID_PASSWORD:"Invalid password",USERID_NOT_AVAILABLE:"User ID does not exist",ROOM_PERMISSION_DENIED:"Room permission denied",ROOM_FULL:"Room full",DID_NOT_JOIN_ANY_ROOM:"Did not join any room yet",INVALID_SOCKET:"Invalid socket",PUBLIC_IDENTIFIER_MISSING:"publicRoomIdentifier is required",INVALID_ADMIN_CREDENTIAL:"Invalid username or password attempted"}}}.call(this,Ve(73).Buffer,Ve(31),Ve(49))},window.EJS_main]).default;